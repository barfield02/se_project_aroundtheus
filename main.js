!function(){"use strict";class e{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._closeButton=this._popupElement.querySelector(".modal__close")}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscape)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscape)}_handleEscape=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close"))&&this.close()}))}}class t extends e{constructor(e,t){super({popupSelector:e}),this._handleFormSubmit=t,this._formElement=this._popupElement.querySelector(".modal__form"),this._inputElements=this._popupElement.querySelectorAll(".modal__input"),this._submitButton=this._popupElement.querySelector(".modal__button")}_getInputValues(){const e={};return this._inputElements.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}resetForm(){this._formElement.reset()}renderLoading(e){this._submitButton.textContent=e?"Saving...":"Save..."}}class r{constructor(e,t,r,n,o){this.name=e.name,this.link=e.link,this._data=e,this.isLiked=e.isLiked,this.id=e._id,this._cardSelector=t,this._handleImageClick=r,this._handleDeleteClick=n,this._handleLikeClick=o}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardImageElement.addEventListener("click",(()=>{this._handleImageClick(this._data)}))}_handleDeleteCard(){this._cardElement.remove()}toggleLikeIcon=()=>{this._likeButton.classList.toggle("card__like-button_active")};getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._cardImageElement=this._cardElement.querySelector(".card__image"),this._cardTitle=this._cardElement.querySelector(".card__title"),this._cardTitle.textContent=this.name,this._cardImageElement.alt=this.name,this._cardImageElement.src=this.link,this.isLiked&&this._likeButton.classList.toggle("card__like-button_active"),this._setEventListeners(),this._cardElement}}class n{constructor(e,t){this._form=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass}_showInputError(e){const t=this._form.querySelector("#"+e.id+"-error");e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector("#"+e.id+"-error");e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_toggleButtonState(){let e=!1;this._inputElements.forEach((t=>{t.validity.valid||(e=!0)})),e?this.disableButton():(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}_setEventListeners(){this._inputElements=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}}const o={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"};document.querySelector(".card__delete-button"),document.querySelector("#delete-card-modal");const s=document.querySelector("#add-card-modal").querySelector("#add-card-form"),i=document.querySelector(".header__logo-button"),a=(s.querySelector("#add-card-title-input"),s.querySelector("#add-card-description-input"),document.querySelector("#modal-add-close-button"),document.querySelector(".profile__add-button")),l=document.querySelector("#profile-edit-button"),c=document.querySelector("#profile-edit-modal"),d=document.querySelector("#profile-avatar-modal"),u=(document.querySelector("#modal-edit-close-button"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-title-input")),m=document.querySelector("#profile-description-input"),h=(document.querySelector(".cards__list"),c.querySelector(".modal__form")),_=d.querySelector(".modal__form"),p=(document.querySelector("#card-template").content.firstElementChild,document.querySelector("#add-image-card-modal"));function E(e){b.open(e)}function S(e){L.open()}function v(e){w.updateLikes(e.isLiked,e.id).then((()=>{e.toggleLikeIcon(),e.isLiked=!e.isLiked}))}function f(e){const t=function(e){return new r(e,"#card-template",E,S,v).getView()}(e);I.addItem(t)}p.querySelector("#add-image-card-form"),p.querySelector(".modal__close"),p.querySelector(".modal__caption"),p.querySelector(".modal__image"),document.querySelector(".modal__button"),new n(o,h).enableValidation();const y=new n(o,s);y.enableValidation();const g=new n(o,_);g.enableValidation();const L=new class extends e{constructor(e){super({popupSelector:e}),this._confirmButton=this._popupElement.querySelector(".delete-button"),this._handleConfirmCallback=null}setConfirmAction(e){this._handleSubtCallback=e}setEventListeners(){super.setEventListeners()}}("#delete-card-modal");L.setEventListeners();const k=new t("#profile-edit-modal",(function(e){k.renderLoading(!0),B.setUserInfo(e.title,e.description),k.close(),k.renderLoading(!1)}));k.setEventListeners();const C=new t("#add-card-modal",(function(e){const t=e.title,r=e["image-url"];C.renderLoading(!0),w.addNewCard({name:t,link:r}).then((e=>{f(e),C.close(),C.resetForm(),y.disableButton(),C.renderLoading(!1)}))}));C.setEventListeners();const b=new class extends e{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._modalImage=this._popupElement.querySelector(".modal__image"),this._imageCaption=this._popupElement.querySelector(".modal__caption")}open(e){this._modalImage.src=e.link,this._modalImage.alt=e.name,this._imageCaption.textContent=e.name,super.open()}}({popupSelector:"#add-image-card-modal"});b.setEventListeners();const q=new t("#profile-avatar-modal",(function(e){q.renderLoading(!0);const t=e.url;w.updateProfilePicture(t).then((()=>{B.setAvatarImage({avatar:t}),q.close(),q.resetForm(),g.disableButton()})).catch((e=>{console.error("Error updatin avatar",e)})).finally((()=>{q.renderLoading(!1)}))}));q.setEventListeners();const I=new class{constructor(e){let{renderer:t,selector:r}=e;this._renderer=t,this._element=document.querySelector(r)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._element.prepend(e)}}({renderer:e=>{f(e)},selector:".cards__list"}),B=new class{constructor(e){let{nameSelector:t,descriptionSelector:r,avatarSelector:n}=e;this._nameElement=document.querySelector(t),this._descriptionElement=document.querySelector(r),this._profileAvatar=document.querySelector(n)}getUserInfo(){return{name:this._nameElement.textContent,description:this._descriptionElement.textContent}}setUserInfo(e,t){this._nameElement.textContent=e,this._descriptionElement.textContent=t}setAvatarImage(e){let{avatar:t}=e;this._profileAvatar.src=t}}({nameSelector:".profile__title",descriptionSelector:".profile__description",avatarSelector:".profile__image"});l.addEventListener("click",(()=>{const e=B.getUserInfo();u.value=e.name,m.value=e.description,k.open()})),a.addEventListener("click",(()=>{C.open()})),i.addEventListener("click",(()=>{q.open()}));const w=new class{constructor(e){}getInitialCards(){return fetch("https://around-api.en.tripleten-services.com/v1/cards",{headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserInfo(){return fetch("https://around-api.en.tripleten-services.com/v1/users/me",{headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df"}}).then((e=>e.json())).then((e=>{console.log(e)}))}editProfileInfo(){return fetch("https://around-api.en.tripleten-services.com/v1/users/me",{method:"PATCH",headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df","Content-Type":"application/json"},body:JSON.stringify({name:"Marie SkÅ‚odowska Curie",about:"Physicist and Chemist"})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addNewCard(e){let{name:t,link:r}=e;return fetch("https://around-api.en.tripleten-services.com/v1/cards",{method:"POST",headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df","Content-Type":"application/json"},body:JSON.stringify({name:t,link:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}DeleteCard(e){return fetch(`https://around-api.en.tripleten-services.com/v1/cards/${e}`,{method:"DELETE",headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df","Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}updateProfilePicture(e){return fetch("https://around-api.en.tripleten-services.com/v1/users/me/avatar",{method:"PATCH",headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df","Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}updateLikes(e,t){return fetch(`https://around-api.en.tripleten-services.com/v1/cards/${t}/likes`,{method:e?"DELETE":"PUT",headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df","Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df","Content-Type":"application/json"}});Promise.all([w.getInitialCards(),w.getUserInfo()]).then((e=>{let[t,r]=e;I.renderItems(t)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QTVELFdBQUFBLENBQVlsRSxFQUFTQyxHQUNuQixPQUFPcUgsTUFDTCx5REFBeURySCxVQUN6RCxDQUNFaUksT0FBUWxJLEVBQVUsU0FBVyxNQUM3QnVILFFBQVMsQ0FDUEMsY0FBZSx1Q0FDZixlQUFnQixzQkFHcEJyRCxNQUFNc0QsR0FDRkEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FHTkMsUUFBUUMsT0FBTyxVQUFVSixFQUFJSyxXQUV4QyxHTDhGa0IsQ0FDbEJVLFFBQVMsa0RBQ1RqQixRQUFTLENBQ1BDLGNBQWUsdUNBQ2YsZUFBZ0Isc0JBa0JwQkksUUFBUWEsSUFBSSxDQUFDeEUsRUFBSW9ELGtCQUFtQnBELEVBQUlnRCxnQkFBZ0I5QyxNQUN0RG5ILElBQXVCLElBQXJCMEwsRUFBT0MsR0FBUzNMLEVBQ2hCd0gsRUFBUStCLFlBQVltQyxFQUFNLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY2FwZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NhcGUpO1xuICB9XG5cbiAgX2hhbmRsZUVzY2FwZSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikgfHxcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIilcbiAgICAgICkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgLy90aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIC8vIHRoaXMuY2xvc2UoKTtcbiAgICAvLyB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gIH1cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcblxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgIH0pO1xuICB9XG4gIHJlc2V0Rm9ybSgpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xuICB9XG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZlLi4uXCI7XG4gICAgfVxuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgZGF0YSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBoYW5kbGVEZWxldGVDbGljayxcbiAgICBoYW5kbGVMaWtlQ2xpY2tcbiAgKSB7XG4gICAgdGhpcy5uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMubGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcbiAgICB0aGlzLmlzTGlrZWQgPSBkYXRhLmlzTGlrZWQ7XG4gICAgdGhpcy5pZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcbiAgfVxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgLy9cIi5jYXJkX19saWtlLWJ1dHRvblwiXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMpO1xuICAgIH0pO1xuXG4gICAgLy9cIi5jYXJkX19kZWxldGUtYnV0dG9uXCJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMpO1xuICAgICAgfSk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX2RhdGEpO1xuICAgIH0pO1xuICB9XG4gIF9oYW5kbGVEZWxldGVDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICB9XG4gIHRvZ2dsZUxpa2VJY29uID0gKCkgPT4ge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgfTtcblxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2NhcmRUaXRsZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5uYW1lO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuYWx0ID0gdGhpcy5uYW1lO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuc3JjID0gdGhpcy5saW5rO1xuICAgIGlmICh0aGlzLmlzTGlrZWQpIHtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIC8vcmV0dXJuIHRoZSBjYXJkXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IodmFsaWRhdGlvblNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gdmFsaWRhdGlvblNldHRpbmdzLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSB2YWxpZGF0aW9uU2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHZhbGlkYXRpb25TZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHZhbGlkYXRpb25TZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHZhbGlkYXRpb25TZXR0aW5ncy5lcnJvckNsYXNzO1xuICB9XG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnRzKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIiNcIiArIGlucHV0RWxlbWVudHMuaWQgKyBcIi1lcnJvclwiXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnRzLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudHMudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIiNcIiArIGlucHV0RWxlbWVudC5pZCArIFwiLWVycm9yXCJcbiAgICApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgbGV0IGZvdW5kSW52YWxpZCA9IGZhbHNlO1xuXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICAgIGZvdW5kSW52YWxpZCA9IHRydWU7XG4gICAgICB9XG4gICAgfSk7XG4gICAgaWYgKGZvdW5kSW52YWxpZCkge1xuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgZGlzYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAvLyBjb25zdCB7IGlucHV0U2VsZWN0b3IgfSA9IG9wdGlvbnM7XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IFsuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xuXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcbiAgfSxcblxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXG4gIH0sXG5dO1xuXG5leHBvcnQgY29uc3QgdmFsaWRhdGlvblNldHRpbmdzID0ge1xuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG59O1xuIiwiaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IHsgaW5pdGlhbENhcmRzLCB2YWxpZGF0aW9uU2V0dGluZ3MgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuXG5jb25zdCBkZWxldGVDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX19kZWxldGUtYnV0dG9uXCIpO1xuY29uc3QgZGVsZXRlQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtY2FyZC1tb2RhbFwiKTtcbmNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XG5jb25zdCBhZGRDYXJkRm9ybUVsZW1lbnQgPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1mb3JtXCIpO1xuY29uc3QgZWRpdEF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaGVhZGVyX19sb2dvLWJ1dHRvblwiKTtcblxuY29uc3QgY2FyZFRpdGxlSW5wdXQgPSBhZGRDYXJkRm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjYWRkLWNhcmQtdGl0bGUtaW5wdXRcIlxuKTtcbmNvbnN0IGNhcmREZXNjcmlwdGlvbklucHV0ID0gYWRkQ2FyZEZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI2FkZC1jYXJkLWRlc2NyaXB0aW9uLWlucHV0XCJcbik7XG5jb25zdCBhZGRDYXJkQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWFkZC1jbG9zZS1idXR0b25cIik7XG5jb25zdCBhZGROZXdDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcbmNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcbmNvbnN0IGF2YXRhckVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hdmF0YXItbW9kYWxcIik7XG5jb25zdCBlZGl0UHJvZmlsZUNsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjbW9kYWwtZWRpdC1jbG9zZS1idXR0b25cIlxuKTtcbmNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xuY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtdGl0bGUtaW5wdXRcIik7XG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcblxuY29uc3QgY2FyZExpc3RFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5jb25zdCBwcm9maWxlRWRpdEZvcm0gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBhdmF0YXJFZGl0Rm9ybSA9IGF2YXRhckVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgY2FyZFRlbXBsYXRlID1cbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XG5cbmNvbnN0IGFkZEltYWdlQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtaW1hZ2UtY2FyZC1tb2RhbFwiKTtcbmNvbnN0IGFkZEltYWdlQ2FyZEZvcm0gPSBhZGRJbWFnZUNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNhZGQtaW1hZ2UtY2FyZC1mb3JtXCJcbik7XG5jb25zdCBhZGRJbWFnZUNhcmRDbG9zZUJ1dHRvbiA9XG4gIGFkZEltYWdlQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xuY29uc3QgaW1hZ2VDYXB0aW9uID0gYWRkSW1hZ2VDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcbmNvbnN0IG1vZGFsSW1hZ2UgPSBhZGRJbWFnZUNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcblxuLy8gZnVuY3Rpb24gaGFuZGxlRXNjYXBlKGV2dCkge1xuLy8gICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuLy8gICAgIGNvbnN0IG9wZW5Nb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfb3BlbmVkXCIpO1xuLy8gICAgIGlmIChvcGVuTW9kYWwpIHtcbi8vICAgICAgIGNsb3NlUG9wdXAob3Blbk1vZGFsKTtcbi8vICAgICB9XG4vLyAgIH1cbi8vIH1cblxuZnVuY3Rpb24gaGFuZGxlQ2FyZENsaWNrKGRhdGEpIHtcbiAgcG9wdXBXaXRoSW1hZ2Uub3BlbihkYXRhKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQoaW5wdXRWYWx1ZXMpIHtcbiAgcG9wdXBFZGl0V2l0aEZvcm0ucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgdXNlckluZm8uc2V0VXNlckluZm8oaW5wdXRWYWx1ZXMudGl0bGUsIGlucHV0VmFsdWVzLmRlc2NyaXB0aW9uKTtcbiAgcG9wdXBFZGl0V2l0aEZvcm0uY2xvc2UoKTtcbiAgcG9wdXBFZGl0V2l0aEZvcm0ucmVuZGVyTG9hZGluZyhmYWxzZSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNsaWNrKGNhcmQpIHtcbiAgcG9wdXBEZWxldGVXaXRoRm9ybS5vcGVuKCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0KGlucHV0VmFsdWVzKSB7XG4gIGNvbnN0IG5hbWUgPSBpbnB1dFZhbHVlcy50aXRsZTtcbiAgY29uc3QgbGluayA9IGlucHV0VmFsdWVzW1wiaW1hZ2UtdXJsXCJdO1xuICBwb3B1cEFkZFdpdGhGb3JtLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gIGFwaS5hZGROZXdDYXJkKHsgbmFtZSwgbGluayB9KS50aGVuKChkYXRhKSA9PiB7XG4gICAgcmVuZGVyQ2FyZChkYXRhKTtcbiAgICBwb3B1cEFkZFdpdGhGb3JtLmNsb3NlKCk7XG4gICAgcG9wdXBBZGRXaXRoRm9ybS5yZXNldEZvcm0oKTtcbiAgICBhZGRGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcbiAgICBwb3B1cEFkZFdpdGhGb3JtLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICB9KTtcbn1cblxuLy9jb25zdCBhYWEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFhYVwiKTtcblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdChkYXRhKSB7XG4gIHBvcHVwQXZhdGFyRWRpdEZvcm0ucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgY29uc3QgdXJsID0gZGF0YS51cmw7XG4gIGFwaVxuICAgIC51cGRhdGVQcm9maWxlUGljdHVyZSh1cmwpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgdXNlckluZm8uc2V0QXZhdGFySW1hZ2UoeyBhdmF0YXI6IHVybCB9KTtcbiAgICAgIHBvcHVwQXZhdGFyRWRpdEZvcm0uY2xvc2UoKTtcbiAgICAgIHBvcHVwQXZhdGFyRWRpdEZvcm0ucmVzZXRGb3JtKCk7XG4gICAgICBlZGl0QXZhdGFyVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB1cGRhdGluIGF2YXRhclwiLCBlcnJvcik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAvLyBQdXQgcmVuZGluZyBsb2FkaW5nIGZhbHNlIGhlcmVcbiAgICAgIHBvcHVwQXZhdGFyRWRpdEZvcm0ucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG59XG5cbmNvbnN0IG1vZGFsU3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICBjYXJkRGF0YSxcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VDbGlja1xuICApO1xuICByZXR1cm4gY2FyZC5nZXRWaWV3KCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUxpa2VDbGljayhjYXJkKSB7XG4gIGFwaS51cGRhdGVMaWtlcyhjYXJkLmlzTGlrZWQsIGNhcmQuaWQpLnRoZW4oKCkgPT4ge1xuICAgIGNhcmQudG9nZ2xlTGlrZUljb24oKTtcbiAgICBjYXJkLmlzTGlrZWQgPSAhY2FyZC5pc0xpa2VkO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gcmVuZGVyQ2FyZChjYXJkRGF0YSkge1xuICAvLyBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGNhcmREYXRhKTtcblxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xuICBzZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICAvLyBjYXJkTGlzdEVsLnByZXBlbmQoY2FyZEVsZW1lbnQpO1xufVxuXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICB2YWxpZGF0aW9uU2V0dGluZ3MsXG4gIHByb2ZpbGVFZGl0Rm9ybVxuKTtcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICB2YWxpZGF0aW9uU2V0dGluZ3MsXG4gIGFkZENhcmRGb3JtRWxlbWVudFxuKTtcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBlZGl0QXZhdGFyVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIHZhbGlkYXRpb25TZXR0aW5ncyxcbiAgYXZhdGFyRWRpdEZvcm1cbik7XG5lZGl0QXZhdGFyVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgcG9wdXBEZWxldGVXaXRoRm9ybSA9IG5ldyBQb3B1cFdpdGhDb25maXJtYXRpb24oXCIjZGVsZXRlLWNhcmQtbW9kYWxcIik7XG5wb3B1cERlbGV0ZVdpdGhGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHBvcHVwRWRpdFdpdGhGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiLFxuICBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdFxuKTtcbnBvcHVwRWRpdFdpdGhGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHBvcHVwQWRkV2l0aEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjYWRkLWNhcmQtbW9kYWxcIixcbiAgaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXRcbik7XG5wb3B1cEFkZFdpdGhGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHBvcHVwV2l0aEltYWdlID0gbmV3IFBvcHVwV2l0aEltYWdlKHtcbiAgcG9wdXBTZWxlY3RvcjogXCIjYWRkLWltYWdlLWNhcmQtbW9kYWxcIixcbn0pO1xucG9wdXBXaXRoSW1hZ2Uuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcG9wdXBBdmF0YXJFZGl0Rm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNwcm9maWxlLWF2YXRhci1tb2RhbFwiLFxuICBoYW5kbGVBdmF0YXJGb3JtU3VibWl0XG4pO1xucG9wdXBBdmF0YXJFZGl0Rm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oe1xuICByZW5kZXJlcjogKGl0ZW0pID0+IHtcbiAgICAvLyBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChpdGVtKTtcblxuICAgIC8vIHNlY3Rpb24uYWRkSXRlbShjYXJkKTtcbiAgICByZW5kZXJDYXJkKGl0ZW0pO1xuICB9LFxuICBzZWxlY3RvcjogXCIuY2FyZHNfX2xpc3RcIixcbn0pO1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fdGl0bGVcIixcbiAgZGVzY3JpcHRpb25TZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXG59KTtcblxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY29uc3QgaW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gaW5mby5uYW1lO1xuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IGluZm8uZGVzY3JpcHRpb247XG4gIHBvcHVwRWRpdFdpdGhGb3JtLm9wZW4oKTtcbn0pO1xuXG5hZGROZXdDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIHBvcHVwQWRkV2l0aEZvcm0ub3BlbigpO1xufSk7XG5cbmVkaXRBdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgcG9wdXBBdmF0YXJFZGl0Rm9ybS5vcGVuKCk7XG59KTtcblxuLy9kZWxldGVDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4vL3BvcHVwRGVsZXRlV2l0aEZvcm0ub3BlbigpO1xuLy99KTtcbi8vIGluc3RhbnRpYXRlIEFQSVxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiNGUxZDgxMDktOWVjZS00NWU4LThjY2QtMTJjN2U0YTIxOWRmXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuLy8gYXBpXG4vLyAgIC5nZXRJbml0aWFsQ2FyZHMoKVxuLy8gICAudGhlbigoZGF0YSkgPT4ge1xuLy8gICAgIC8vIGRhdGEgd2lsbCBiZSBhbiBhcnJheSB3aXRoIDEgY2FyZCBpbiBpdFxuLy8gICB9KVxuLy8gICAuY2F0Y2goKGVycikgPT4ge30pO1xuXG4vLyBhcGlcbi8vICAgLmdldFVzZXJJbmZvKClcbi8vICAgLnRoZW4oKGRhdGEpID0+IHtcbi8vICAgICAvLyBkYXRhIHdpbGwgYmUgYW4gYXJyYXkgd2l0aCAxIGNhcmQgaW4gaXRcbi8vICAgfSlcbi8vICAgLmNhdGNoKChlcnIpID0+IHt9KTtcblxuUHJvbWlzZS5hbGwoW2FwaS5nZXRJbml0aWFsQ2FyZHMoKSwgYXBpLmdldFVzZXJJbmZvKCldKS50aGVuKFxuICAoW2NhcmRzLCB1c2VyRGF0YV0pID0+IHtcbiAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKGNhcmRzKTtcbiAgfVxuKTtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fY29uZmlybUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmRlbGV0ZS1idXR0b25cIik7XG4gICAgdGhpcy5faGFuZGxlQ29uZmlybUNhbGxiYWNrID0gbnVsbDtcbiAgfVxuXG4gIHNldENvbmZpcm1BY3Rpb24oY2FsbGJhY2spIHtcbiAgICB0aGlzLl9oYW5kbGVTdWJ0Q2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgLy8gdGhpcy5fY29uZmlybUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIC8vICAgdGhpcy5faGFuZGxlQ29uZmlybUNhbGxiYWNrKCk7XG4gICAgLy8gfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fbW9kYWxJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcbiAgICB0aGlzLl9pbWFnZUNhcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcbiAgfVxuICBvcGVuKGRhdGEpIHtcbiAgICB0aGlzLl9tb2RhbEltYWdlLnNyYyA9IGRhdGEubGluaztcbiAgICB0aGlzLl9tb2RhbEltYWdlLmFsdCA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9pbWFnZUNhcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciwgc2VsZWN0b3IgfSkge1xuICAgIC8vIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJJdGVtcyhpdGVtcykge1xuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkSXRlbShpdGVtKSB7XG4gICAgdGhpcy5fZWxlbWVudC5wcmVwZW5kKGl0ZW0pO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBkZXNjcmlwdGlvblNlbGVjdG9yLCBhdmF0YXJTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fZGVzY3JpcHRpb25FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihkZXNjcmlwdGlvblNlbGVjdG9yKTtcbiAgICB0aGlzLl9wcm9maWxlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XG4gIH1cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX2Rlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICB9O1xuICB9XG5cbiAgc2V0VXNlckluZm8odGl0bGUsIGRlc2NyaXB0aW9uKSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aXRsZTtcbiAgICB0aGlzLl9kZXNjcmlwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBkZXNjcmlwdGlvbjtcbiAgfVxuXG4gIHNldEF2YXRhckltYWdlKHsgYXZhdGFyIH0pIHtcbiAgICB0aGlzLl9wcm9maWxlQXZhdGFyLnNyYyA9IGF2YXRhcjtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIC8vIGNvbnN0cnVjdG9yIGJvZHlcbiAgfVxuXG4gIC8vIEdFVCAvdXNlcnMvbWVcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxL2NhcmRzXCIsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCI0ZTFkODEwOS05ZWNlLTQ1ZTgtOGNjZC0xMmM3ZTRhMjE5ZGZcIixcbiAgICAgIH0sXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBHRVQgL2NhcmRzXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxL3VzZXJzL21lXCIsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCI0ZTFkODEwOS05ZWNlLTQ1ZTgtOGNjZC0xMmM3ZTRhMjE5ZGZcIixcbiAgICAgIH0sXG4gICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHJlcy5qc29uKCkpXG4gICAgICAudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XG4gICAgICB9KTtcbiAgfVxuICBlZGl0UHJvZmlsZUluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjEvdXNlcnMvbWVcIiwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IFwiNGUxZDgxMDktOWVjZS00NWU4LThjY2QtMTJjN2U0YTIxOWRmXCIsXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogXCJNYXJpZSBTa8WCb2Rvd3NrYSBDdXJpZVwiLFxuICAgICAgICBhYm91dDogXCJQaHlzaWNpc3QgYW5kIENoZW1pc3RcIixcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG4gIGFkZE5ld0NhcmQoeyBuYW1lLCBsaW5rIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MS9jYXJkc1wiLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiBcIjRlMWQ4MTA5LTllY2UtNDVlOC04Y2NkLTEyYzdlNGEyMTlkZlwiLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuICBEZWxldGVDYXJkKGlkKSB7XG4gICAgcmV0dXJuIGZldGNoKFxuICAgICAgYGh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxL2NhcmRzLyR7aWR9YCxcbiAgICAgIHtcbiAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgYXV0aG9yaXphdGlvbjogXCI0ZTFkODEwOS05ZWNlLTQ1ZTgtOGNjZC0xMmM3ZTRhMjE5ZGZcIixcbiAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgfSxcbiAgICAgIH1cbiAgICApLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG4gIHVwZGF0ZVByb2ZpbGVQaWN0dXJlKGF2YXRhcikge1xuICAgIHJldHVybiBmZXRjaChcbiAgICAgIFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjEvdXNlcnMvbWUvYXZhdGFyXCIsXG4gICAgICB7XG4gICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgYXV0aG9yaXphdGlvbjogXCI0ZTFkODEwOS05ZWNlLTQ1ZTgtOGNjZC0xMmM3ZTRhMjE5ZGZcIixcbiAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGF2YXRhcixcbiAgICAgICAgfSksXG4gICAgICB9XG4gICAgKS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuICB1cGRhdGVMaWtlcyhpc0xpa2VkLCBpZCkge1xuICAgIHJldHVybiBmZXRjaChcbiAgICAgIGBodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MS9jYXJkcy8ke2lkfS9saWtlc2AsXG4gICAgICB7XG4gICAgICAgIG1ldGhvZDogaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgYXV0aG9yaXphdGlvbjogXCI0ZTFkODEwOS05ZWNlLTQ1ZTgtOGNjZC0xMmM3ZTRhMjE5ZGZcIixcbiAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgfSxcbiAgICAgIH1cbiAgICApLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsiUG9wdXAiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJwb3B1cFNlbGVjdG9yIiwidGhpcyIsIl9wb3B1cEVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJfY2xvc2VCdXR0b24iLCJvcGVuIiwiY2xhc3NMaXN0IiwiYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVFc2NhcGUiLCJjbG9zZSIsInJlbW92ZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0RWxlbWVudHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ1dHRvbiIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwiZm9yRWFjaCIsImlucHV0IiwibmFtZSIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJyZXNldEZvcm0iLCJyZXNldCIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJ0ZXh0Q29udGVudCIsIkNhcmQiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwibGluayIsIl9kYXRhIiwiaXNMaWtlZCIsImlkIiwiX2lkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiX2NhcmRFbGVtZW50IiwiX2NhcmRJbWFnZUVsZW1lbnQiLCJfaGFuZGxlRGVsZXRlQ2FyZCIsInRvZ2dsZUxpa2VJY29uIiwidG9nZ2xlIiwiZ2V0VmlldyIsImNvbnRlbnQiLCJjbG9uZU5vZGUiLCJfY2FyZFRpdGxlIiwiYWx0Iiwic3JjIiwiRm9ybVZhbGlkYXRvciIsInZhbGlkYXRpb25TZXR0aW5ncyIsImZvcm1FbGVtZW50IiwiX2Zvcm0iLCJfaW5wdXRTZWxlY3RvciIsImlucHV0U2VsZWN0b3IiLCJfc3VibWl0QnV0dG9uU2VsZWN0b3IiLCJzdWJtaXRCdXR0b25TZWxlY3RvciIsIl9pbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiaW5hY3RpdmVCdXR0b25DbGFzcyIsIl9pbnB1dEVycm9yQ2xhc3MiLCJpbnB1dEVycm9yQ2xhc3MiLCJfZXJyb3JDbGFzcyIsImVycm9yQ2xhc3MiLCJfc2hvd0lucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnRzIiwiZXJyb3JNZXNzYWdlRWwiLCJ2YWxpZGF0aW9uTWVzc2FnZSIsIl9oaWRlSW5wdXRFcnJvciIsImlucHV0RWxlbWVudCIsIl9jaGVja0lucHV0VmFsaWRpdHkiLCJ2YWxpZGl0eSIsInZhbGlkIiwiX3RvZ2dsZUJ1dHRvblN0YXRlIiwiZm91bmRJbnZhbGlkIiwiZGlzYWJsZUJ1dHRvbiIsImRpc2FibGVkIiwiZW5hYmxlVmFsaWRhdGlvbiIsImUiLCJhZGRDYXJkRm9ybUVsZW1lbnQiLCJlZGl0QXZhdGFyQnV0dG9uIiwiYWRkTmV3Q2FyZEJ1dHRvbiIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUVkaXRNb2RhbCIsImF2YXRhckVkaXRNb2RhbCIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJwcm9maWxlRWRpdEZvcm0iLCJhdmF0YXJFZGl0Rm9ybSIsImFkZEltYWdlQ2FyZE1vZGFsIiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJoYW5kbGVDYXJkQ2xpY2siLCJwb3B1cFdpdGhJbWFnZSIsImNhcmQiLCJwb3B1cERlbGV0ZVdpdGhGb3JtIiwiYXBpIiwidXBkYXRlTGlrZXMiLCJ0aGVuIiwicmVuZGVyQ2FyZCIsImNhcmREYXRhIiwiY2FyZEVsZW1lbnQiLCJjcmVhdGVDYXJkIiwic2VjdGlvbiIsImFkZEl0ZW0iLCJhZGRGb3JtVmFsaWRhdG9yIiwiZWRpdEF2YXRhclZhbGlkYXRvciIsIl9jb25maXJtQnV0dG9uIiwiX2hhbmRsZUNvbmZpcm1DYWxsYmFjayIsInNldENvbmZpcm1BY3Rpb24iLCJjYWxsYmFjayIsIl9oYW5kbGVTdWJ0Q2FsbGJhY2siLCJwb3B1cEVkaXRXaXRoRm9ybSIsInVzZXJJbmZvIiwic2V0VXNlckluZm8iLCJ0aXRsZSIsImRlc2NyaXB0aW9uIiwicG9wdXBBZGRXaXRoRm9ybSIsImFkZE5ld0NhcmQiLCJfbW9kYWxJbWFnZSIsIl9pbWFnZUNhcHRpb24iLCJwb3B1cEF2YXRhckVkaXRGb3JtIiwidXJsIiwidXBkYXRlUHJvZmlsZVBpY3R1cmUiLCJzZXRBdmF0YXJJbWFnZSIsImF2YXRhciIsImNhdGNoIiwiZXJyb3IiLCJjb25zb2xlIiwiZmluYWxseSIsInJlbmRlcmVyIiwic2VsZWN0b3IiLCJfcmVuZGVyZXIiLCJfZWxlbWVudCIsInJlbmRlckl0ZW1zIiwiaXRlbXMiLCJpdGVtIiwicHJlcGVuZCIsIm5hbWVTZWxlY3RvciIsImRlc2NyaXB0aW9uU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9kZXNjcmlwdGlvbkVsZW1lbnQiLCJfcHJvZmlsZUF2YXRhciIsImdldFVzZXJJbmZvIiwiX3JlZjIiLCJpbmZvIiwib3B0aW9ucyIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwicmVzdWx0IiwibG9nIiwiZWRpdFByb2ZpbGVJbmZvIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsIkRlbGV0ZUNhcmQiLCJiYXNlVXJsIiwiYWxsIiwiY2FyZHMiLCJ1c2VyRGF0YSJdLCJzb3VyY2VSb290IjoiIn0=