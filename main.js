!function(){"use strict";class e{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._closeButton=this._popupElement.querySelector(".modal__close")}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscape)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscape)}_handleEscape=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close"))&&this.close()}))}}class t extends e{constructor(e,t){super({popupSelector:e}),this._handleFormSubmit=t,this._formElement=this._popupElement.querySelector(".modal__form"),this._inputElements=this._popupElement.querySelectorAll(".modal__input"),this._submitButton=this._popupElement.querySelector(".modal__button")}_getInputValues(){const e={};return this._inputElements.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}resetForm(){this._formElement.reset()}renderLoading(e){this._submitButton.textContent=e?"Saving...":"Save..."}}class r{constructor(e,t,r,o,n){this.name=e.name,this.link=e.link,this._data=e,this.isLiked=e.isLiked,this.id=e._id,this._cardSelector=t,this._handleImageClick=r,this._handleDeleteClick=o,this._handleLikeClick=n}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardImageElement.addEventListener("click",(()=>{this._handleImageClick(this._data)}))}removeCard(){this._cardElement.remove()}toggleLikeIcon=()=>{this._likeButton.classList.toggle("card__like-button_active")};getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._cardImageElement=this._cardElement.querySelector(".card__image"),this._cardTitle=this._cardElement.querySelector(".card__title"),this._cardTitle.textContent=this.name,this._cardImageElement.alt=this.name,this._cardImageElement.src=this.link,this.isLiked&&this._likeButton.classList.toggle("card__like-button_active"),this._setEventListeners(),this._cardElement}}class o{constructor(e,t){this._form=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass}_showInputError(e){const t=this._form.querySelector("#"+e.id+"-error");e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector("#"+e.id+"-error");e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_toggleButtonState(){let e=!1;this._inputElements.forEach((t=>{t.validity.valid||(e=!0)})),e?this.disableButton():(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}_setEventListeners(){this._inputElements=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}}const n={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},s=document.querySelector("#delete-card-form"),i=(document.querySelector("#modal-delete-card-close-button"),document.querySelector("#delete-card-modal"),document.querySelector("#add-card-modal").querySelector("#add-card-form")),a=document.querySelector(".header__logo-button"),l=(i.querySelector("#add-card-title-input"),i.querySelector("#add-card-description-input"),document.querySelector("#modal-add-close-button"),document.querySelector(".profile__add-button")),c=document.querySelector("#profile-edit-button"),d=document.querySelector("#profile-edit-modal"),u=document.querySelector("#profile-avatar-modal"),m=(document.querySelector("#modal-edit-close-button"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-title-input")),h=document.querySelector("#profile-description-input"),_=(document.querySelector(".cards__list"),d.querySelector(".modal__form")),p=u.querySelector(".modal__form"),E=(document.querySelector("#card-template").content.firstElementChild,document.querySelector("#add-image-card-modal"));function S(e){q.open(e)}function v(e){k.open(),k.setConfirmAction((()=>{j.deleteCard(e.id).then((()=>{e.removeCard(),k.close()})).catch(console.error)}))}function f(e){j.updateLikes(e.isLiked,e.id).then((()=>{e.toggleLikeIcon(),e.isLiked=!e.isLiked}))}function y(e){const t=function(e){return new r(e,"#card-template",S,v,f).getView()}(e);B.addItem(t)}E.querySelector("#add-image-card-form"),E.querySelector(".modal__close"),E.querySelector(".modal__caption"),E.querySelector(".modal__image"),document.querySelector(".modal__button"),new o(n,_).enableValidation();const L=new o(n,i);L.enableValidation();const g=new o(n,p);g.enableValidation(),new o(n,s).enableValidation();const k=new class extends e{constructor(e){super({popupSelector:e}),this._confirmButton=this._popupElement.querySelector(".modal__delete-button"),this._handleSubmitCallback=null}setConfirmAction(e){this._handleSubmitCallback=e}setEventListeners(){super.setEventListeners(),this._confirmButton.addEventListener("click",(()=>{this._handleSubmitCallback()}))}}("#delete-card-modal");k.setEventListeners();const C=new t("#profile-edit-modal",(function(e){C.renderLoading(!0),w.setUserInfo(e.title,e.description),C.close(),C.renderLoading(!1)}));C.setEventListeners();const b=new t("#add-card-modal",(function(e){const t=e.title,r=e["image-url"];b.renderLoading(!0),j.addNewCard({name:t,link:r}).then((e=>{y(e),b.close(),b.resetForm(),L.disableButton(),b.renderLoading(!1)}))}));b.setEventListeners();const q=new class extends e{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._modalImage=this._popupElement.querySelector(".modal__image"),this._imageCaption=this._popupElement.querySelector(".modal__caption")}open(e){this._modalImage.src=e.link,this._modalImage.alt=e.name,this._imageCaption.textContent=e.name,super.open()}}({popupSelector:"#add-image-card-modal"});q.setEventListeners();const I=new t("#profile-avatar-modal",(function(e){I.renderLoading(!0);const t=e.url;j.updateProfilePicture(t).then((()=>{w.setAvatarImage({avatar:t}),I.close(),I.resetForm(),g.disableButton()})).catch((e=>{console.error("Error updatin avatar",e)})).finally((()=>{I.renderLoading(!1)}))}));I.setEventListeners();const B=new class{constructor(e){let{renderer:t,selector:r}=e;this._renderer=t,this._element=document.querySelector(r)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._element.prepend(e)}}({renderer:e=>{y(e)},selector:".cards__list"}),w=new class{constructor(e){let{nameSelector:t,descriptionSelector:r,avatarSelector:o}=e;this._nameElement=document.querySelector(t),this._descriptionElement=document.querySelector(r),this._profileAvatar=document.querySelector(o)}getUserInfo(){return{name:this._nameElement.textContent,description:this._descriptionElement.textContent}}setUserInfo(e,t){this._nameElement.textContent=e,this._descriptionElement.textContent=t}setAvatarImage(e){let{avatar:t}=e;this._profileAvatar.src=t}}({nameSelector:".profile__title",descriptionSelector:".profile__description",avatarSelector:".profile__image"});c.addEventListener("click",(()=>{const e=w.getUserInfo();m.value=e.name,h.value=e.description,C.open()})),l.addEventListener("click",(()=>{b.open()})),a.addEventListener("click",(()=>{I.open()}));const j=new class{constructor(e){}getInitialCards(){return fetch("https://around-api.en.tripleten-services.com/v1/cards",{headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserInfo(){return fetch("https://around-api.en.tripleten-services.com/v1/users/me",{headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df"}}).then((e=>e.json())).then((e=>{console.log(e)}))}editProfileInfo(){return fetch("https://around-api.en.tripleten-services.com/v1/users/me",{method:"PATCH",headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df","Content-Type":"application/json"},body:JSON.stringify({name:"Marie SkÅ‚odowska Curie",about:"Physicist and Chemist"})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addNewCard(e){let{name:t,link:r}=e;return fetch("https://around-api.en.tripleten-services.com/v1/cards",{method:"POST",headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df","Content-Type":"application/json"},body:JSON.stringify({name:t,link:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteCard(e){return fetch(`https://around-api.en.tripleten-services.com/v1/cards/${e}`,{method:"DELETE",headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df","Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}updateProfilePicture(e){return fetch("https://around-api.en.tripleten-services.com/v1/users/me/avatar",{method:"PATCH",headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df","Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}updateLikes(e,t){return fetch(`https://around-api.en.tripleten-services.com/v1/cards/${t}/likes`,{method:e?"DELETE":"PUT",headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df","Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df","Content-Type":"application/json"}});Promise.all([j.getInitialCards(),j.getUserInfo()]).then((e=>{let[t,r]=e;B.renderItems(t)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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LE9BR05DLFFBQVFDLE9BQU8sVUFBVUosRUFBSUssV0FFeEMsQ0FDQS9CLG9CQUFBQSxDQUFxQkUsR0FDbkIsT0FBT3FCLE1BQ0wsa0VBQ0EsQ0FDRVksT0FBUSxRQUNSWCxRQUFTLENBQ1BDLGNBQWUsdUNBQ2YsZUFBZ0Isb0JBRWxCVyxLQUFNQyxLQUFLQyxVQUFVLENBQ25CcEMsYUFHSjdCLE1BQU1xRCxHQUNGQSxFQUFJQyxHQUNDRCxFQUFJRSxPQUdOQyxRQUFRQyxPQUFPLFVBQVVKLEVBQUlLLFdBRXhDLENBQ0F0RCxXQUFBQSxDQUFZekUsRUFBU0MsR0FDbkIsT0FBT3NILE1BQ0wseURBQXlEdEgsVUFDekQsQ0FDRWtJLE9BQVFuSSxFQUFVLFNBQVcsTUFDN0J3SCxRQUFTLENBQ1BDLGNBQWUsdUNBQ2YsZUFBZ0Isc0JBR3BCcEQsTUFBTXFELEdBQ0ZBLEVBQUlDLEdBQ0NELEVBQUlFLE9BR05DLFFBQVFDLE9BQU8sVUFBVUosRUFBSUssV0FFeEMsR0w2SGtCLENBQ2xCUyxRQUFTLGtEQUNUaEIsUUFBUyxDQUNQQyxjQUFlLHVDQUNmLGVBQWdCLHNCQWtCcEJJLFFBQVFZLElBQUksQ0FBQ3RFLEVBQUltRCxrQkFBbUJuRCxFQUFJK0MsZ0JBQWdCN0MsTUFDdERySCxJQUF1QixJQUFyQjBMLEVBQU9DLEdBQVMzTCxFQUNoQjhILEVBQVEwQixZQUFZa0MsRUFBTSxHIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXAuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoRm9ybS5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9DYXJkLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL3V0aWxzL2NvbnN0YW50cy5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvcGFnZXMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL1NlY3Rpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvVXNlckluZm8uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvQXBpLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHBvcHVwU2VsZWN0b3IpO1xuICAgIHRoaXMuX2Nsb3NlQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xuICB9XG5cbiAgb3BlbigpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LmFkZChcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NhcGUpO1xuICB9XG5cbiAgY2xvc2UoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUoXCJtb2RhbF9vcGVuZWRcIik7XG4gICAgZG9jdW1lbnQucmVtb3ZlRXZlbnRMaXN0ZW5lcihcImtleWRvd25cIiwgdGhpcy5faGFuZGxlRXNjYXBlKTtcbiAgfVxuXG4gIF9oYW5kbGVFc2NhcGUgPSAoZXZ0KSA9PiB7XG4gICAgaWYgKGV2dC5rZXkgPT09IFwiRXNjYXBlXCIpIHtcbiAgICAgIHRoaXMuY2xvc2UoKTtcbiAgICB9XG4gIH07XG5cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgdGhpcy5fcG9wdXBFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJtb3VzZWRvd25cIiwgKGV2dCkgPT4ge1xuICAgICAgaWYgKFxuICAgICAgICBldnQudGFyZ2V0LmNsYXNzTGlzdC5jb250YWlucyhcIm1vZGFsXCIpIHx8XG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxfX2Nsb3NlXCIpXG4gICAgICApIHtcbiAgICAgICAgdGhpcy5jbG9zZSgpO1xuICAgICAgfVxuICAgIH0pO1xuICAgIC8vdGhpcy5fY2xvc2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAvLyB0aGlzLmNsb3NlKCk7XG4gICAgLy8gfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhGb3JtIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcihwb3B1cFNlbGVjdG9yLCBoYW5kbGVGb3JtU3VibWl0KSB7XG4gICAgc3VwZXIoeyBwb3B1cFNlbGVjdG9yIH0pO1xuICAgIHRoaXMuX2hhbmRsZUZvcm1TdWJtaXQgPSBoYW5kbGVGb3JtU3VibWl0O1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50ID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yQWxsKFwiLm1vZGFsX19pbnB1dFwiKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuICB9XG4gIF9nZXRJbnB1dFZhbHVlcygpIHtcbiAgICBjb25zdCBpbnB1dFZhbHVlcyA9IHt9O1xuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXQpID0+IHtcbiAgICAgIGlucHV0VmFsdWVzW2lucHV0Lm5hbWVdID0gaW5wdXQudmFsdWU7XG4gICAgfSk7XG5cbiAgICByZXR1cm4gaW5wdXRWYWx1ZXM7XG4gIH1cbiAgc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgc3VwZXIuc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwic3VibWl0XCIsIChldnQpID0+IHtcbiAgICAgIGV2dC5wcmV2ZW50RGVmYXVsdCgpO1xuICAgICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCh0aGlzLl9nZXRJbnB1dFZhbHVlcygpKTtcbiAgICB9KTtcbiAgfVxuICByZXNldEZvcm0oKSB7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQucmVzZXQoKTtcbiAgfVxuICByZW5kZXJMb2FkaW5nKGlzTG9hZGluZykge1xuICAgIGlmIChpc0xvYWRpbmcpIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2aW5nLi4uXCI7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi50ZXh0Q29udGVudCA9IFwiU2F2ZS4uLlwiO1xuICAgIH1cbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQ2FyZCB7XG4gIGNvbnN0cnVjdG9yKFxuICAgIGRhdGEsXG4gICAgY2FyZFNlbGVjdG9yLFxuICAgIGhhbmRsZUltYWdlQ2xpY2ssXG4gICAgaGFuZGxlRGVsZXRlQ2xpY2ssXG4gICAgaGFuZGxlTGlrZUNsaWNrXG4gICkge1xuICAgIHRoaXMubmFtZSA9IGRhdGEubmFtZTtcbiAgICB0aGlzLmxpbmsgPSBkYXRhLmxpbms7XG4gICAgdGhpcy5fZGF0YSA9IGRhdGE7XG4gICAgdGhpcy5pc0xpa2VkID0gZGF0YS5pc0xpa2VkO1xuICAgIHRoaXMuaWQgPSBkYXRhLl9pZDtcbiAgICB0aGlzLl9jYXJkU2VsZWN0b3IgPSBjYXJkU2VsZWN0b3I7XG4gICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayA9IGhhbmRsZUltYWdlQ2xpY2s7XG4gICAgdGhpcy5faGFuZGxlRGVsZXRlQ2xpY2sgPSBoYW5kbGVEZWxldGVDbGljaztcbiAgICB0aGlzLl9oYW5kbGVMaWtlQ2xpY2sgPSBoYW5kbGVMaWtlQ2xpY2s7XG4gIH1cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIC8vXCIuY2FyZF9fbGlrZS1idXR0b25cIlxuICAgIHRoaXMuX2xpa2VCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayh0aGlzKTtcbiAgICB9KTtcblxuICAgIC8vXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiXG4gICAgdGhpcy5fY2FyZEVsZW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2RlbGV0ZS1idXR0b25cIilcbiAgICAgIC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayh0aGlzKTtcbiAgICAgIH0pO1xuXG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlSW1hZ2VDbGljayh0aGlzLl9kYXRhKTtcbiAgICB9KTtcbiAgfVxuICByZW1vdmVDYXJkKCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50LnJlbW92ZSgpO1xuICB9XG4gIHRvZ2dsZUxpa2VJY29uID0gKCkgPT4ge1xuICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgfTtcblxuICBnZXRWaWV3KCkge1xuICAgIHRoaXMuX2NhcmRFbGVtZW50ID0gZG9jdW1lbnRcbiAgICAgIC5xdWVyeVNlbGVjdG9yKHRoaXMuX2NhcmRTZWxlY3RvcilcbiAgICAgIC5jb250ZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZFwiKVxuICAgICAgLmNsb25lTm9kZSh0cnVlKTtcblxuICAgIHRoaXMuX2xpa2VCdXR0b24gPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2xpa2UtYnV0dG9uXCIpO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQgPSB0aGlzLl9jYXJkRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLmNhcmRfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2NhcmRUaXRsZSA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fdGl0bGVcIik7XG4gICAgdGhpcy5fY2FyZFRpdGxlLnRleHRDb250ZW50ID0gdGhpcy5uYW1lO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuYWx0ID0gdGhpcy5uYW1lO1xuICAgIHRoaXMuX2NhcmRJbWFnZUVsZW1lbnQuc3JjID0gdGhpcy5saW5rO1xuICAgIGlmICh0aGlzLmlzTGlrZWQpIHtcbiAgICAgIHRoaXMuX2xpa2VCdXR0b24uY2xhc3NMaXN0LnRvZ2dsZShcImNhcmRfX2xpa2UtYnV0dG9uX2FjdGl2ZVwiKTtcbiAgICB9XG5cbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICAgIC8vcmV0dXJuIHRoZSBjYXJkXG4gICAgcmV0dXJuIHRoaXMuX2NhcmRFbGVtZW50O1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBGb3JtVmFsaWRhdG9yIHtcbiAgY29uc3RydWN0b3IodmFsaWRhdGlvblNldHRpbmdzLCBmb3JtRWxlbWVudCkge1xuICAgIHRoaXMuX2Zvcm0gPSBmb3JtRWxlbWVudDtcbiAgICB0aGlzLl9pbnB1dFNlbGVjdG9yID0gdmFsaWRhdGlvblNldHRpbmdzLmlucHV0U2VsZWN0b3I7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IgPSB2YWxpZGF0aW9uU2V0dGluZ3Muc3VibWl0QnV0dG9uU2VsZWN0b3I7XG4gICAgdGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyA9IHZhbGlkYXRpb25TZXR0aW5ncy5pbmFjdGl2ZUJ1dHRvbkNsYXNzO1xuICAgIHRoaXMuX2lucHV0RXJyb3JDbGFzcyA9IHZhbGlkYXRpb25TZXR0aW5ncy5pbnB1dEVycm9yQ2xhc3M7XG4gICAgdGhpcy5fZXJyb3JDbGFzcyA9IHZhbGlkYXRpb25TZXR0aW5ncy5lcnJvckNsYXNzO1xuICB9XG4gIF9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnRzKSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIiNcIiArIGlucHV0RWxlbWVudHMuaWQgKyBcIi1lcnJvclwiXG4gICAgKTtcbiAgICBpbnB1dEVsZW1lbnRzLmNsYXNzTGlzdC5hZGQodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IGlucHV0RWxlbWVudHMudmFsaWRhdGlvbk1lc3NhZ2U7XG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LmFkZCh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuICBfaGlkZUlucHV0RXJyb3IoaW5wdXRFbGVtZW50KSB7XG4gICAgY29uc3QgZXJyb3JNZXNzYWdlRWwgPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIiNcIiArIGlucHV0RWxlbWVudC5pZCArIFwiLWVycm9yXCJcbiAgICApO1xuICAgIGlucHV0RWxlbWVudC5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2lucHV0RXJyb3JDbGFzcyk7XG4gICAgZXJyb3JNZXNzYWdlRWwudGV4dENvbnRlbnQgPSBcIlwiO1xuICAgIGVycm9yTWVzc2FnZUVsLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5fZXJyb3JDbGFzcyk7XG4gIH1cblxuICBfY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCkge1xuICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICB0aGlzLl9zaG93SW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpO1xuICAgIH1cbiAgfVxuICBfdG9nZ2xlQnV0dG9uU3RhdGUoKSB7XG4gICAgbGV0IGZvdW5kSW52YWxpZCA9IGZhbHNlO1xuXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlmICghaW5wdXRFbGVtZW50LnZhbGlkaXR5LnZhbGlkKSB7XG4gICAgICAgIGZvdW5kSW52YWxpZCA9IHRydWU7XG4gICAgICB9XG4gICAgfSk7XG4gICAgaWYgKGZvdW5kSW52YWxpZCkge1xuICAgICAgdGhpcy5kaXNhYmxlQnV0dG9uKCk7XG4gICAgICByZXR1cm47XG4gICAgfVxuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QucmVtb3ZlKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IGZhbHNlO1xuICB9XG5cbiAgZGlzYWJsZUJ1dHRvbigpIHtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uY2xhc3NMaXN0LmFkZCh0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzKTtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b24uZGlzYWJsZWQgPSB0cnVlO1xuICB9XG5cbiAgZW5hYmxlVmFsaWRhdGlvbigpIHtcbiAgICB0aGlzLl9mb3JtLmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgfSk7XG4gICAgdGhpcy5fc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfVxuXG4gIF9zZXRFdmVudExpc3RlbmVycygpIHtcbiAgICAvLyBjb25zdCB7IGlucHV0U2VsZWN0b3IgfSA9IG9wdGlvbnM7XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cyA9IFsuLi50aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3JBbGwodGhpcy5faW5wdXRTZWxlY3RvcildO1xuXG4gICAgdGhpcy5fc3VibWl0QnV0dG9uID0gdGhpcy5fZm9ybS5xdWVyeVNlbGVjdG9yKHRoaXMuX3N1Ym1pdEJ1dHRvblNlbGVjdG9yKTtcblxuICAgIHRoaXMuX2lucHV0RWxlbWVudHMuZm9yRWFjaCgoaW5wdXRFbGVtZW50KSA9PiB7XG4gICAgICBpbnB1dEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcImlucHV0XCIsIChlKSA9PiB7XG4gICAgICAgIHRoaXMuX2NoZWNrSW5wdXRWYWxpZGl0eShpbnB1dEVsZW1lbnQpO1xuICAgICAgICB0aGlzLl90b2dnbGVCdXR0b25TdGF0ZSgpO1xuICAgICAgfSk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImV4cG9ydCBjb25zdCBpbml0aWFsQ2FyZHMgPSBbXG4gIHtcbiAgICBuYW1lOiBcIllvc2VtaXRlIFZhbGxleVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC95b3NlbWl0ZS5qcGdcIixcbiAgfSxcblxuICB7XG4gICAgbmFtZTogXCJMYWtlIExvdWlzZVwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYWtlLWxvdWlzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiQmFsZCBNb3VudGFpbnNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvYmFsZC1tb3VudGFpbnMuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhdGVtYXJcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGF0ZW1hci5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiVmFub2lzZSBOYXRpb25hbCBQYXJrXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3Zhbm9pc2UuanBnXCIsXG4gIH0sXG4gIHtcbiAgICBuYW1lOiBcIkxhZ28gZGkgQnJhaWVzXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xhZ28uanBnXCIsXG4gIH0sXG5dO1xuXG5leHBvcnQgY29uc3QgdmFsaWRhdGlvblNldHRpbmdzID0ge1xuICBpbnB1dFNlbGVjdG9yOiBcIi5tb2RhbF9faW5wdXRcIixcbiAgc3VibWl0QnV0dG9uU2VsZWN0b3I6IFwiLm1vZGFsX19idXR0b25cIixcbiAgaW5hY3RpdmVCdXR0b25DbGFzczogXCJtb2RhbF9fYnV0dG9uX2Rpc2FibGVkXCIsXG4gIGlucHV0RXJyb3JDbGFzczogXCJtb2RhbF9faW5wdXRfdHlwZV9lcnJvclwiLFxuICBlcnJvckNsYXNzOiBcIm1vZGFsX19lcnJvcl92aXNpYmxlXCIsXG59O1xuIiwiaW1wb3J0IFBvcHVwV2l0aEltYWdlIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEltYWdlLmpzXCI7XG5pbXBvcnQgUG9wdXBXaXRoRm9ybSBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzXCI7XG5pbXBvcnQgVXNlckluZm8gZnJvbSBcIi4uL2NvbXBvbmVudHMvVXNlckluZm8uanNcIjtcbmltcG9ydCBTZWN0aW9uIGZyb20gXCIuLi9jb21wb25lbnRzL1NlY3Rpb24uanNcIjtcbmltcG9ydCBDYXJkIGZyb20gXCIuLi9jb21wb25lbnRzL0NhcmQuanNcIjtcbmltcG9ydCBGb3JtVmFsaWRhdG9yIGZyb20gXCIuLi9jb21wb25lbnRzL0Zvcm1WYWxpZGF0b3IuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhDb25maXJtYXRpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoQ29uZmlybWF0aW9uLmpzXCI7XG5pbXBvcnQgXCIuL2luZGV4LmNzc1wiO1xuaW1wb3J0IHsgaW5pdGlhbENhcmRzLCB2YWxpZGF0aW9uU2V0dGluZ3MgfSBmcm9tIFwiLi4vdXRpbHMvY29uc3RhbnRzLmpzXCI7XG5pbXBvcnQgQXBpIGZyb20gXCIuLi9jb21wb25lbnRzL0FwaS5qc1wiO1xuXG5jb25zdCBkZWxldGVDYXJkRm9ybSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjZGVsZXRlLWNhcmQtZm9ybVwiKTtcblxuY29uc3QgZGVsZXRlQ2FyZEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI21vZGFsLWRlbGV0ZS1jYXJkLWNsb3NlLWJ1dHRvblwiXG4pO1xuY29uc3QgZGVsZXRlQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtY2FyZC1tb2RhbFwiKTtcbmNvbnN0IGFkZENhcmRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjYWRkLWNhcmQtbW9kYWxcIik7XG5jb25zdCBhZGRDYXJkRm9ybUVsZW1lbnQgPSBhZGRDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1mb3JtXCIpO1xuY29uc3QgZWRpdEF2YXRhckJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuaGVhZGVyX19sb2dvLWJ1dHRvblwiKTtcblxuY29uc3QgY2FyZFRpdGxlSW5wdXQgPSBhZGRDYXJkRm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjYWRkLWNhcmQtdGl0bGUtaW5wdXRcIlxuKTtcbmNvbnN0IGNhcmREZXNjcmlwdGlvbklucHV0ID0gYWRkQ2FyZEZvcm1FbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI2FkZC1jYXJkLWRlc2NyaXB0aW9uLWlucHV0XCJcbik7XG5jb25zdCBhZGRDYXJkQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI21vZGFsLWFkZC1jbG9zZS1idXR0b25cIik7XG5jb25zdCBhZGROZXdDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX19hZGQtYnV0dG9uXCIpO1xuXG5jb25zdCBwcm9maWxlRWRpdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LWJ1dHRvblwiKTtcbmNvbnN0IHByb2ZpbGVFZGl0TW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtZWRpdC1tb2RhbFwiKTtcbmNvbnN0IGF2YXRhckVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1hdmF0YXItbW9kYWxcIik7XG5jb25zdCBlZGl0UHJvZmlsZUNsb3NlQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjbW9kYWwtZWRpdC1jbG9zZS1idXR0b25cIlxuKTtcbmNvbnN0IHByb2ZpbGVUaXRsZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fdGl0bGVcIik7XG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2Rlc2NyaXB0aW9uXCIpO1xuY29uc3QgcHJvZmlsZVRpdGxlSW5wdXQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI3Byb2ZpbGUtdGl0bGUtaW5wdXRcIik7XG5jb25zdCBwcm9maWxlRGVzY3JpcHRpb25JbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI3Byb2ZpbGUtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcblxuY29uc3QgY2FyZExpc3RFbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZHNfX2xpc3RcIik7XG5jb25zdCBwcm9maWxlRWRpdEZvcm0gPSBwcm9maWxlRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBhdmF0YXJFZGl0Rm9ybSA9IGF2YXRhckVkaXRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19mb3JtXCIpO1xuY29uc3QgY2FyZFRlbXBsYXRlID1cbiAgZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNjYXJkLXRlbXBsYXRlXCIpLmNvbnRlbnQuZmlyc3RFbGVtZW50Q2hpbGQ7XG5cbmNvbnN0IGFkZEltYWdlQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtaW1hZ2UtY2FyZC1tb2RhbFwiKTtcbmNvbnN0IGFkZEltYWdlQ2FyZEZvcm0gPSBhZGRJbWFnZUNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFxuICBcIiNhZGQtaW1hZ2UtY2FyZC1mb3JtXCJcbik7XG5jb25zdCBhZGRJbWFnZUNhcmRDbG9zZUJ1dHRvbiA9XG4gIGFkZEltYWdlQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Nsb3NlXCIpO1xuY29uc3QgaW1hZ2VDYXB0aW9uID0gYWRkSW1hZ2VDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcbmNvbnN0IG1vZGFsSW1hZ2UgPSBhZGRJbWFnZUNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcblxuLy8gZnVuY3Rpb24gaGFuZGxlRXNjYXBlKGV2dCkge1xuLy8gICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuLy8gICAgIGNvbnN0IG9wZW5Nb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfb3BlbmVkXCIpO1xuLy8gICAgIGlmIChvcGVuTW9kYWwpIHtcbi8vICAgICAgIGNsb3NlUG9wdXAob3Blbk1vZGFsKTtcbi8vICAgICB9XG4vLyAgIH1cbi8vIH1cblxuZnVuY3Rpb24gaGFuZGxlQ2FyZENsaWNrKGRhdGEpIHtcbiAgcG9wdXBXaXRoSW1hZ2Uub3BlbihkYXRhKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXQoaW5wdXRWYWx1ZXMpIHtcbiAgcG9wdXBFZGl0V2l0aEZvcm0ucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgdXNlckluZm8uc2V0VXNlckluZm8oaW5wdXRWYWx1ZXMudGl0bGUsIGlucHV0VmFsdWVzLmRlc2NyaXB0aW9uKTtcbiAgcG9wdXBFZGl0V2l0aEZvcm0uY2xvc2UoKTtcbiAgcG9wdXBFZGl0V2l0aEZvcm0ucmVuZGVyTG9hZGluZyhmYWxzZSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNsaWNrKGNhcmQpIHtcbiAgcG9wdXBEZWxldGVXaXRoRm9ybS5vcGVuKCk7XG4gIHBvcHVwRGVsZXRlV2l0aEZvcm0uc2V0Q29uZmlybUFjdGlvbigoKSA9PiB7XG4gICAgYXBpXG4gICAgICAuZGVsZXRlQ2FyZChjYXJkLmlkKVxuICAgICAgLnRoZW4oKCkgPT4ge1xuICAgICAgICBjYXJkLnJlbW92ZUNhcmQoKTtcbiAgICAgICAgcG9wdXBEZWxldGVXaXRoRm9ybS5jbG9zZSgpO1xuICAgICAgfSlcbiAgICAgIC5jYXRjaChjb25zb2xlLmVycm9yKTtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0KGlucHV0VmFsdWVzKSB7XG4gIGNvbnN0IG5hbWUgPSBpbnB1dFZhbHVlcy50aXRsZTtcbiAgY29uc3QgbGluayA9IGlucHV0VmFsdWVzW1wiaW1hZ2UtdXJsXCJdO1xuICBwb3B1cEFkZFdpdGhGb3JtLnJlbmRlckxvYWRpbmcodHJ1ZSk7XG4gIGFwaS5hZGROZXdDYXJkKHsgbmFtZSwgbGluayB9KS50aGVuKChkYXRhKSA9PiB7XG4gICAgcmVuZGVyQ2FyZChkYXRhKTtcbiAgICBwb3B1cEFkZFdpdGhGb3JtLmNsb3NlKCk7XG4gICAgcG9wdXBBZGRXaXRoRm9ybS5yZXNldEZvcm0oKTtcbiAgICBhZGRGb3JtVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcbiAgICBwb3B1cEFkZFdpdGhGb3JtLnJlbmRlckxvYWRpbmcoZmFsc2UpO1xuICB9KTtcbn1cblxuLy9jb25zdCBhYWEgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZChcImFhYVwiKTtcblxuZnVuY3Rpb24gaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdChkYXRhKSB7XG4gIHBvcHVwQXZhdGFyRWRpdEZvcm0ucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgY29uc3QgdXJsID0gZGF0YS51cmw7XG4gIGFwaVxuICAgIC51cGRhdGVQcm9maWxlUGljdHVyZSh1cmwpXG4gICAgLnRoZW4oKCkgPT4ge1xuICAgICAgdXNlckluZm8uc2V0QXZhdGFySW1hZ2UoeyBhdmF0YXI6IHVybCB9KTtcbiAgICAgIHBvcHVwQXZhdGFyRWRpdEZvcm0uY2xvc2UoKTtcbiAgICAgIHBvcHVwQXZhdGFyRWRpdEZvcm0ucmVzZXRGb3JtKCk7XG4gICAgICBlZGl0QXZhdGFyVmFsaWRhdG9yLmRpc2FibGVCdXR0b24oKTtcbiAgICB9KVxuICAgIC5jYXRjaCgoZXJyb3IpID0+IHtcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciB1cGRhdGluIGF2YXRhclwiLCBlcnJvcik7XG4gICAgfSlcbiAgICAuZmluYWxseSgoKSA9PiB7XG4gICAgICAvLyBQdXQgcmVuZGluZyBsb2FkaW5nIGZhbHNlIGhlcmVcbiAgICAgIHBvcHVwQXZhdGFyRWRpdEZvcm0ucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gICAgfSk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZURlbGV0ZUNhcmRTdWJtaXQoKSB7XG4gIGFwaS5kZWxldGVDYXJkKCgpID0+IHtcbiAgICBkZWxldGVDYXJkQnV0dG9uLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gIH0pO1xufVxuXG5jb25zdCBtb2RhbFN1Ym1pdEJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2J1dHRvblwiKTtcblxuZnVuY3Rpb24gY3JlYXRlQ2FyZChjYXJkRGF0YSkge1xuICBjb25zdCBjYXJkID0gbmV3IENhcmQoXG4gICAgY2FyZERhdGEsXG4gICAgXCIjY2FyZC10ZW1wbGF0ZVwiLFxuICAgIGhhbmRsZUNhcmRDbGljayxcbiAgICBoYW5kbGVEZWxldGVDbGljayxcbiAgICBoYW5kbGVMaWtlQ2xpY2tcbiAgKTtcbiAgcmV0dXJuIGNhcmQuZ2V0VmlldygpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVMaWtlQ2xpY2soY2FyZCkge1xuICBhcGkudXBkYXRlTGlrZXMoY2FyZC5pc0xpa2VkLCBjYXJkLmlkKS50aGVuKCgpID0+IHtcbiAgICBjYXJkLnRvZ2dsZUxpa2VJY29uKCk7XG4gICAgY2FyZC5pc0xpa2VkID0gIWNhcmQuaXNMaWtlZDtcbiAgfSk7XG59XG5cbmZ1bmN0aW9uIHJlbmRlckNhcmQoY2FyZERhdGEpIHtcbiAgLy8gY29uc3QgY2FyZEVsZW1lbnQgPSBnZXRDYXJkRWxlbWVudChjYXJkRGF0YSk7XG5cbiAgY29uc3QgY2FyZEVsZW1lbnQgPSBjcmVhdGVDYXJkKGNhcmREYXRhKTtcbiAgc2VjdGlvbi5hZGRJdGVtKGNhcmRFbGVtZW50KTtcbiAgLy8gY2FyZExpc3RFbC5wcmVwZW5kKGNhcmRFbGVtZW50KTtcbn1cblxuY29uc3QgZWRpdEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGlvblNldHRpbmdzLFxuICBwcm9maWxlRWRpdEZvcm1cbik7XG5lZGl0Rm9ybVZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IGFkZEZvcm1WYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGlvblNldHRpbmdzLFxuICBhZGRDYXJkRm9ybUVsZW1lbnRcbik7XG5hZGRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgZWRpdEF2YXRhclZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICB2YWxpZGF0aW9uU2V0dGluZ3MsXG4gIGF2YXRhckVkaXRGb3JtXG4pO1xuZWRpdEF2YXRhclZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IGRlbGV0ZUNhcmRWYWxpZGF0b3IgPSBuZXcgRm9ybVZhbGlkYXRvcihcbiAgdmFsaWRhdGlvblNldHRpbmdzLFxuICBkZWxldGVDYXJkRm9ybVxuKTtcbmRlbGV0ZUNhcmRWYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBwb3B1cERlbGV0ZVdpdGhGb3JtID0gbmV3IFBvcHVwV2l0aENvbmZpcm1hdGlvbihcIiNkZWxldGUtY2FyZC1tb2RhbFwiKTtcbnBvcHVwRGVsZXRlV2l0aEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcG9wdXBFZGl0V2l0aEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIsXG4gIGhhbmRsZVByb2ZpbGVFZGl0U3VibWl0XG4pO1xucG9wdXBFZGl0V2l0aEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcG9wdXBBZGRXaXRoRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNhZGQtY2FyZC1tb2RhbFwiLFxuICBoYW5kbGVBZGRDYXJkRm9ybVN1Ym1pdFxuKTtcbnBvcHVwQWRkV2l0aEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuY29uc3QgcG9wdXBXaXRoSW1hZ2UgPSBuZXcgUG9wdXBXaXRoSW1hZ2Uoe1xuICBwb3B1cFNlbGVjdG9yOiBcIiNhZGQtaW1hZ2UtY2FyZC1tb2RhbFwiLFxufSk7XG5wb3B1cFdpdGhJbWFnZS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBwb3B1cEF2YXRhckVkaXRGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI3Byb2ZpbGUtYXZhdGFyLW1vZGFsXCIsXG4gIGhhbmRsZUF2YXRhckZvcm1TdWJtaXRcbik7XG5wb3B1cEF2YXRhckVkaXRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbi8vIGNvbnN0IHBvcHVwRGVsZXRlQ2FyZEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcbi8vICAgXCIjZGVsZXRlLWNhcmQtbW9kYWxcIlxuLy8gICAvL2hhbmRsZURlXG4vLyApO1xuLy8gcG9wdXBEZWxldGVDYXJkRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBzZWN0aW9uID0gbmV3IFNlY3Rpb24oe1xuICByZW5kZXJlcjogKGl0ZW0pID0+IHtcbiAgICAvLyBjb25zdCBjYXJkID0gY3JlYXRlQ2FyZChpdGVtKTtcblxuICAgIC8vIHNlY3Rpb24uYWRkSXRlbShjYXJkKTtcbiAgICByZW5kZXJDYXJkKGl0ZW0pO1xuICB9LFxuICBzZWxlY3RvcjogXCIuY2FyZHNfX2xpc3RcIixcbn0pO1xuXG5jb25zdCB1c2VySW5mbyA9IG5ldyBVc2VySW5mbyh7XG4gIG5hbWVTZWxlY3RvcjogXCIucHJvZmlsZV9fdGl0bGVcIixcbiAgZGVzY3JpcHRpb25TZWxlY3RvcjogXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIixcbiAgYXZhdGFyU2VsZWN0b3I6IFwiLnByb2ZpbGVfX2ltYWdlXCIsXG59KTtcblxucHJvZmlsZUVkaXRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgY29uc3QgaW5mbyA9IHVzZXJJbmZvLmdldFVzZXJJbmZvKCk7XG4gIHByb2ZpbGVUaXRsZUlucHV0LnZhbHVlID0gaW5mby5uYW1lO1xuICBwcm9maWxlRGVzY3JpcHRpb25JbnB1dC52YWx1ZSA9IGluZm8uZGVzY3JpcHRpb247XG4gIHBvcHVwRWRpdFdpdGhGb3JtLm9wZW4oKTtcbn0pO1xuXG5hZGROZXdDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gIHBvcHVwQWRkV2l0aEZvcm0ub3BlbigpO1xufSk7XG5cbmVkaXRBdmF0YXJCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgcG9wdXBBdmF0YXJFZGl0Rm9ybS5vcGVuKCk7XG59KTtcblxuLy9kZWxldGVDYXJkQnV0dG9uLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4vL3BvcHVwRGVsZXRlV2l0aEZvcm0ub3BlbigpO1xuLy99KTtcbi8vIGluc3RhbnRpYXRlIEFQSVxuY29uc3QgYXBpID0gbmV3IEFwaSh7XG4gIGJhc2VVcmw6IFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjFcIixcbiAgaGVhZGVyczoge1xuICAgIGF1dGhvcml6YXRpb246IFwiNGUxZDgxMDktOWVjZS00NWU4LThjY2QtMTJjN2U0YTIxOWRmXCIsXG4gICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gIH0sXG59KTtcblxuLy8gYXBpXG4vLyAgIC5nZXRJbml0aWFsQ2FyZHMoKVxuLy8gICAudGhlbigoZGF0YSkgPT4ge1xuLy8gICAgIC8vIGRhdGEgd2lsbCBiZSBhbiBhcnJheSB3aXRoIDEgY2FyZCBpbiBpdFxuLy8gICB9KVxuLy8gICAuY2F0Y2goKGVycikgPT4ge30pO1xuXG4vLyBhcGlcbi8vICAgLmdldFVzZXJJbmZvKClcbi8vICAgLnRoZW4oKGRhdGEpID0+IHtcbi8vICAgICAvLyBkYXRhIHdpbGwgYmUgYW4gYXJyYXkgd2l0aCAxIGNhcmQgaW4gaXRcbi8vICAgfSlcbi8vICAgLmNhdGNoKChlcnIpID0+IHt9KTtcblxuUHJvbWlzZS5hbGwoW2FwaS5nZXRJbml0aWFsQ2FyZHMoKSwgYXBpLmdldFVzZXJJbmZvKCldKS50aGVuKFxuICAoW2NhcmRzLCB1c2VyRGF0YV0pID0+IHtcbiAgICBzZWN0aW9uLnJlbmRlckl0ZW1zKGNhcmRzKTtcbiAgfVxuKTtcbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi9Qb3B1cFwiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhDb25maXJtYXRpb24gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fY29uZmlybUJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICAgICAgXCIubW9kYWxfX2RlbGV0ZS1idXR0b25cIlxuICAgICk7XG4gICAgdGhpcy5faGFuZGxlU3VibWl0Q2FsbGJhY2sgPSBudWxsO1xuICB9XG5cbiAgc2V0Q29uZmlybUFjdGlvbihjYWxsYmFjaykge1xuICAgIHRoaXMuX2hhbmRsZVN1Ym1pdENhbGxiYWNrID0gY2FsbGJhY2s7XG4gIH1cblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2NvbmZpcm1CdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgICAgIHRoaXMuX2hhbmRsZVN1Ym1pdENhbGxiYWNrKCk7XG4gICAgfSk7XG4gIH1cbn1cbiIsImltcG9ydCBQb3B1cCBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cC5qc1wiO1xuXG5leHBvcnQgZGVmYXVsdCBjbGFzcyBQb3B1cFdpdGhJbWFnZSBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IoeyBwb3B1cFNlbGVjdG9yIH0pIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5fbW9kYWxJbWFnZSA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19pbWFnZVwiKTtcbiAgICB0aGlzLl9pbWFnZUNhcHRpb24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2FwdGlvblwiKTtcbiAgfVxuICBvcGVuKGRhdGEpIHtcbiAgICB0aGlzLl9tb2RhbEltYWdlLnNyYyA9IGRhdGEubGluaztcbiAgICB0aGlzLl9tb2RhbEltYWdlLmFsdCA9IGRhdGEubmFtZTtcbiAgICB0aGlzLl9pbWFnZUNhcHRpb24udGV4dENvbnRlbnQgPSBkYXRhLm5hbWU7XG4gICAgc3VwZXIub3BlbigpO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBTZWN0aW9uIHtcbiAgY29uc3RydWN0b3IoeyByZW5kZXJlciwgc2VsZWN0b3IgfSkge1xuICAgIC8vIHRoaXMuX2l0ZW1zID0gaXRlbXM7XG4gICAgdGhpcy5fcmVuZGVyZXIgPSByZW5kZXJlcjtcbiAgICB0aGlzLl9lbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihzZWxlY3Rvcik7XG4gIH1cblxuICByZW5kZXJJdGVtcyhpdGVtcykge1xuICAgIGl0ZW1zLmZvckVhY2goKGl0ZW0pID0+IHtcbiAgICAgIHRoaXMuX3JlbmRlcmVyKGl0ZW0pO1xuICAgIH0pO1xuICB9XG5cbiAgYWRkSXRlbShpdGVtKSB7XG4gICAgdGhpcy5fZWxlbWVudC5wcmVwZW5kKGl0ZW0pO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBVc2VySW5mbyB7XG4gIGNvbnN0cnVjdG9yKHsgbmFtZVNlbGVjdG9yLCBkZXNjcmlwdGlvblNlbGVjdG9yLCBhdmF0YXJTZWxlY3RvciB9KSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKG5hbWVTZWxlY3Rvcik7XG4gICAgdGhpcy5fZGVzY3JpcHRpb25FbGVtZW50ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihkZXNjcmlwdGlvblNlbGVjdG9yKTtcbiAgICB0aGlzLl9wcm9maWxlQXZhdGFyID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihhdmF0YXJTZWxlY3Rvcik7XG4gIH1cbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIHtcbiAgICAgIG5hbWU6IHRoaXMuX25hbWVFbGVtZW50LnRleHRDb250ZW50LFxuICAgICAgZGVzY3JpcHRpb246IHRoaXMuX2Rlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCxcbiAgICB9O1xuICB9XG5cbiAgc2V0VXNlckluZm8odGl0bGUsIGRlc2NyaXB0aW9uKSB7XG4gICAgdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQgPSB0aXRsZTtcbiAgICB0aGlzLl9kZXNjcmlwdGlvbkVsZW1lbnQudGV4dENvbnRlbnQgPSBkZXNjcmlwdGlvbjtcbiAgfVxuXG4gIHNldEF2YXRhckltYWdlKHsgYXZhdGFyIH0pIHtcbiAgICB0aGlzLl9wcm9maWxlQXZhdGFyLnNyYyA9IGF2YXRhcjtcbiAgfVxufVxuIiwiZXhwb3J0IGRlZmF1bHQgY2xhc3MgQXBpIHtcbiAgY29uc3RydWN0b3Iob3B0aW9ucykge1xuICAgIC8vIGNvbnN0cnVjdG9yIGJvZHlcbiAgfVxuXG4gIC8vIEdFVCAvdXNlcnMvbWVcbiAgZ2V0SW5pdGlhbENhcmRzKCkge1xuICAgIHJldHVybiBmZXRjaChcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxL2NhcmRzXCIsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCI0ZTFkODEwOS05ZWNlLTQ1ZTgtOGNjZC0xMmM3ZTRhMjE5ZGZcIixcbiAgICAgIH0sXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cblxuICAvLyBHRVQgL2NhcmRzXG4gIGdldFVzZXJJbmZvKCkge1xuICAgIHJldHVybiBmZXRjaChcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxL3VzZXJzL21lXCIsIHtcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCI0ZTFkODEwOS05ZWNlLTQ1ZTgtOGNjZC0xMmM3ZTRhMjE5ZGZcIixcbiAgICAgIH0sXG4gICAgfSlcbiAgICAgIC50aGVuKChyZXMpID0+IHJlcy5qc29uKCkpXG4gICAgICAudGhlbigocmVzdWx0KSA9PiB7XG4gICAgICAgIGNvbnNvbGUubG9nKHJlc3VsdCk7XG4gICAgICB9KTtcbiAgfVxuICBlZGl0UHJvZmlsZUluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjEvdXNlcnMvbWVcIiwge1xuICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IFwiNGUxZDgxMDktOWVjZS00NWU4LThjY2QtMTJjN2U0YTIxOWRmXCIsXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZTogXCJNYXJpZSBTa8WCb2Rvd3NrYSBDdXJpZVwiLFxuICAgICAgICBhYm91dDogXCJQaHlzaWNpc3QgYW5kIENoZW1pc3RcIixcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG4gIGFkZE5ld0NhcmQoeyBuYW1lLCBsaW5rIH0pIHtcbiAgICByZXR1cm4gZmV0Y2goXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MS9jYXJkc1wiLCB7XG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiBcIjRlMWQ4MTA5LTllY2UtNDVlOC04Y2NkLTEyYzdlNGEyMTlkZlwiLFxuICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgIH0sXG4gICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgIG5hbWUsXG4gICAgICAgIGxpbmssXG4gICAgICB9KSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuICBkZWxldGVDYXJkKGlkKSB7XG4gICAgcmV0dXJuIGZldGNoKFxuICAgICAgYGh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxL2NhcmRzLyR7aWR9YCxcbiAgICAgIHtcbiAgICAgICAgbWV0aG9kOiBcIkRFTEVURVwiLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgYXV0aG9yaXphdGlvbjogXCI0ZTFkODEwOS05ZWNlLTQ1ZTgtOGNjZC0xMmM3ZTRhMjE5ZGZcIixcbiAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgfSxcbiAgICAgIH1cbiAgICApLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG4gIHVwZGF0ZVByb2ZpbGVQaWN0dXJlKGF2YXRhcikge1xuICAgIHJldHVybiBmZXRjaChcbiAgICAgIFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjEvdXNlcnMvbWUvYXZhdGFyXCIsXG4gICAgICB7XG4gICAgICAgIG1ldGhvZDogXCJQQVRDSFwiLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgYXV0aG9yaXphdGlvbjogXCI0ZTFkODEwOS05ZWNlLTQ1ZTgtOGNjZC0xMmM3ZTRhMjE5ZGZcIixcbiAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgfSxcbiAgICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICAgIGF2YXRhcixcbiAgICAgICAgfSksXG4gICAgICB9XG4gICAgKS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuICB1cGRhdGVMaWtlcyhpc0xpa2VkLCBpZCkge1xuICAgIHJldHVybiBmZXRjaChcbiAgICAgIGBodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MS9jYXJkcy8ke2lkfS9saWtlc2AsXG4gICAgICB7XG4gICAgICAgIG1ldGhvZDogaXNMaWtlZCA/IFwiREVMRVRFXCIgOiBcIlBVVFwiLFxuICAgICAgICBoZWFkZXJzOiB7XG4gICAgICAgICAgYXV0aG9yaXphdGlvbjogXCI0ZTFkODEwOS05ZWNlLTQ1ZTgtOGNjZC0xMmM3ZTRhMjE5ZGZcIixcbiAgICAgICAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgICAgICAgfSxcbiAgICAgIH1cbiAgICApLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG59XG4iXSwibmFtZXMiOlsiUG9wdXAiLCJjb25zdHJ1Y3RvciIsIl9yZWYiLCJwb3B1cFNlbGVjdG9yIiwidGhpcyIsIl9wb3B1cEVsZW1lbnQiLCJkb2N1bWVudCIsInF1ZXJ5U2VsZWN0b3IiLCJfY2xvc2VCdXR0b24iLCJvcGVuIiwiY2xhc3NMaXN0IiwiYWRkIiwiYWRkRXZlbnRMaXN0ZW5lciIsIl9oYW5kbGVFc2NhcGUiLCJjbG9zZSIsInJlbW92ZSIsInJlbW92ZUV2ZW50TGlzdGVuZXIiLCJldnQiLCJrZXkiLCJzZXRFdmVudExpc3RlbmVycyIsInRhcmdldCIsImNvbnRhaW5zIiwiUG9wdXBXaXRoRm9ybSIsImhhbmRsZUZvcm1TdWJtaXQiLCJzdXBlciIsIl9oYW5kbGVGb3JtU3VibWl0IiwiX2Zvcm1FbGVtZW50IiwiX2lucHV0RWxlbWVudHMiLCJxdWVyeVNlbGVjdG9yQWxsIiwiX3N1Ym1pdEJ1dHRvbiIsIl9nZXRJbnB1dFZhbHVlcyIsImlucHV0VmFsdWVzIiwiZm9yRWFjaCIsImlucHV0IiwibmFtZSIsInZhbHVlIiwicHJldmVudERlZmF1bHQiLCJyZXNldEZvcm0iLCJyZXNldCIsInJlbmRlckxvYWRpbmciLCJpc0xvYWRpbmciLCJ0ZXh0Q29udGVudCIsIkNhcmQiLCJkYXRhIiwiY2FyZFNlbGVjdG9yIiwiaGFuZGxlSW1hZ2VDbGljayIsImhhbmRsZURlbGV0ZUNsaWNrIiwiaGFuZGxlTGlrZUNsaWNrIiwibGluayIsIl9kYXRhIiwiaXNMaWtlZCIsImlkIiwiX2lkIiwiX2NhcmRTZWxlY3RvciIsIl9oYW5kbGVJbWFnZUNsaWNrIiwiX2hhbmRsZURlbGV0ZUNsaWNrIiwiX2hhbmRsZUxpa2VDbGljayIsIl9zZXRFdmVudExpc3RlbmVycyIsIl9saWtlQnV0dG9uIiwiX2NhcmRFbGVtZW50IiwiX2NhcmRJbWFnZUVsZW1lbnQiLCJyZW1vdmVDYXJkIiwidG9nZ2xlTGlrZUljb24iLCJ0b2dnbGUiLCJnZXRWaWV3IiwiY29udGVudCIsImNsb25lTm9kZSIsIl9jYXJkVGl0bGUiLCJhbHQiLCJzcmMiLCJGb3JtVmFsaWRhdG9yIiwidmFsaWRhdGlvblNldHRpbmdzIiwiZm9ybUVsZW1lbnQiLCJfZm9ybSIsIl9pbnB1dFNlbGVjdG9yIiwiaW5wdXRTZWxlY3RvciIsIl9zdWJtaXRCdXR0b25TZWxlY3RvciIsInN1Ym1pdEJ1dHRvblNlbGVjdG9yIiwiX2luYWN0aXZlQnV0dG9uQ2xhc3MiLCJpbmFjdGl2ZUJ1dHRvbkNsYXNzIiwiX2lucHV0RXJyb3JDbGFzcyIsImlucHV0RXJyb3JDbGFzcyIsIl9lcnJvckNsYXNzIiwiZXJyb3JDbGFzcyIsIl9zaG93SW5wdXRFcnJvciIsImlucHV0RWxlbWVudHMiLCJlcnJvck1lc3NhZ2VFbCIsInZhbGlkYXRpb25NZXNzYWdlIiwiX2hpZGVJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50IiwiX2NoZWNrSW5wdXRWYWxpZGl0eSIsInZhbGlkaXR5IiwidmFsaWQiLCJfdG9nZ2xlQnV0dG9uU3RhdGUiLCJmb3VuZEludmFsaWQiLCJkaXNhYmxlQnV0dG9uIiwiZGlzYWJsZWQiLCJlbmFibGVWYWxpZGF0aW9uIiwiZSIsImRlbGV0ZUNhcmRGb3JtIiwiYWRkQ2FyZEZvcm1FbGVtZW50IiwiZWRpdEF2YXRhckJ1dHRvbiIsImFkZE5ld0NhcmRCdXR0b24iLCJwcm9maWxlRWRpdEJ1dHRvbiIsInByb2ZpbGVFZGl0TW9kYWwiLCJhdmF0YXJFZGl0TW9kYWwiLCJwcm9maWxlVGl0bGVJbnB1dCIsInByb2ZpbGVEZXNjcmlwdGlvbklucHV0IiwicHJvZmlsZUVkaXRGb3JtIiwiYXZhdGFyRWRpdEZvcm0iLCJhZGRJbWFnZUNhcmRNb2RhbCIsImZpcnN0RWxlbWVudENoaWxkIiwiaGFuZGxlQ2FyZENsaWNrIiwicG9wdXBXaXRoSW1hZ2UiLCJjYXJkIiwicG9wdXBEZWxldGVXaXRoRm9ybSIsInNldENvbmZpcm1BY3Rpb24iLCJhcGkiLCJkZWxldGVDYXJkIiwidGhlbiIsImNhdGNoIiwiY29uc29sZSIsImVycm9yIiwidXBkYXRlTGlrZXMiLCJyZW5kZXJDYXJkIiwiY2FyZERhdGEiLCJjYXJkRWxlbWVudCIsImNyZWF0ZUNhcmQiLCJzZWN0aW9uIiwiYWRkSXRlbSIsImFkZEZvcm1WYWxpZGF0b3IiLCJlZGl0QXZhdGFyVmFsaWRhdG9yIiwiX2NvbmZpcm1CdXR0b24iLCJfaGFuZGxlU3VibWl0Q2FsbGJhY2siLCJjYWxsYmFjayIsInBvcHVwRWRpdFdpdGhGb3JtIiwidXNlckluZm8iLCJzZXRVc2VySW5mbyIsInRpdGxlIiwiZGVzY3JpcHRpb24iLCJwb3B1cEFkZFdpdGhGb3JtIiwiYWRkTmV3Q2FyZCIsIl9tb2RhbEltYWdlIiwiX2ltYWdlQ2FwdGlvbiIsInBvcHVwQXZhdGFyRWRpdEZvcm0iLCJ1cmwiLCJ1cGRhdGVQcm9maWxlUGljdHVyZSIsInNldEF2YXRhckltYWdlIiwiYXZhdGFyIiwiZmluYWxseSIsInJlbmRlcmVyIiwic2VsZWN0b3IiLCJfcmVuZGVyZXIiLCJfZWxlbWVudCIsInJlbmRlckl0ZW1zIiwiaXRlbXMiLCJpdGVtIiwicHJlcGVuZCIsIm5hbWVTZWxlY3RvciIsImRlc2NyaXB0aW9uU2VsZWN0b3IiLCJhdmF0YXJTZWxlY3RvciIsIl9uYW1lRWxlbWVudCIsIl9kZXNjcmlwdGlvbkVsZW1lbnQiLCJfcHJvZmlsZUF2YXRhciIsImdldFVzZXJJbmZvIiwiX3JlZjIiLCJpbmZvIiwib3B0aW9ucyIsImdldEluaXRpYWxDYXJkcyIsImZldGNoIiwiaGVhZGVycyIsImF1dGhvcml6YXRpb24iLCJyZXMiLCJvayIsImpzb24iLCJQcm9taXNlIiwicmVqZWN0Iiwic3RhdHVzIiwicmVzdWx0IiwibG9nIiwiZWRpdFByb2ZpbGVJbmZvIiwibWV0aG9kIiwiYm9keSIsIkpTT04iLCJzdHJpbmdpZnkiLCJhYm91dCIsImJhc2VVcmwiLCJhbGwiLCJjYXJkcyIsInVzZXJEYXRhIl0sInNvdXJjZVJvb3QiOiIifQ==