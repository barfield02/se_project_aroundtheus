!function(){"use strict";class e{constructor(e){let{popupSelector:t}=e;this._popupElement=document.querySelector(t),this._closeButton=this._popupElement.querySelector(".modal__close")}open(){this._popupElement.classList.add("modal_opened"),document.addEventListener("keydown",this._handleEscape)}close(){this._popupElement.classList.remove("modal_opened"),document.removeEventListener("keydown",this._handleEscape)}_handleEscape=e=>{"Escape"===e.key&&this.close()};setEventListeners(){this._popupElement.addEventListener("mousedown",(e=>{(e.target.classList.contains("modal")||e.target.classList.contains("modal__close"))&&this.close()}))}}class t extends e{constructor(e,t){super({popupSelector:e}),this._handleFormSubmit=t,this._formElement=this._popupElement.querySelector(".modal__form"),this._inputElements=this._popupElement.querySelectorAll(".modal__input"),this._submitButton=this._popupElement.querySelector(".modal__button")}_getInputValues(){const e={};return this._inputElements.forEach((t=>{e[t.name]=t.value})),e}setEventListeners(){super.setEventListeners(),this._formElement.addEventListener("submit",(e=>{e.preventDefault(),this._handleFormSubmit(this._getInputValues())}))}resetForm(){this._formElement.reset()}renderLoading(e){this._submitButton.textContent=e?"Saving...":"Save..."}}class r{constructor(e,t,r,o,n){this.name=e.name,this.link=e.link,this._data=e,this.isLiked=e.isLiked,this.id=e._id,this._cardSelector=t,this._handleImageClick=r,this._handleDeleteClick=o,this._handleLikeClick=n}_setEventListeners(){this._likeButton.addEventListener("click",(()=>{this._handleLikeClick(this)})),this._cardElement.querySelector(".card__delete-button").addEventListener("click",(()=>{this._handleDeleteClick(this)})),this._cardImageElement.addEventListener("click",(()=>{this._handleImageClick(this._data)}))}removeCard(){this._cardElement.remove()}toggleLikeIcon=()=>{this._likeButton.classList.toggle("card__like-button_active")};getView(){return this._cardElement=document.querySelector(this._cardSelector).content.querySelector(".card").cloneNode(!0),this._likeButton=this._cardElement.querySelector(".card__like-button"),this._cardImageElement=this._cardElement.querySelector(".card__image"),this._cardTitle=this._cardElement.querySelector(".card__title"),this._cardTitle.textContent=this.name,this._cardImageElement.alt=this.name,this._cardImageElement.src=this.link,this.isLiked&&this._likeButton.classList.toggle("card__like-button_active"),this._setEventListeners(),this._cardElement}}class o{constructor(e,t){this._form=t,this._inputSelector=e.inputSelector,this._submitButtonSelector=e.submitButtonSelector,this._inactiveButtonClass=e.inactiveButtonClass,this._inputErrorClass=e.inputErrorClass,this._errorClass=e.errorClass}_showInputError(e){const t=this._form.querySelector("#"+e.id+"-error");e.classList.add(this._inputErrorClass),t.textContent=e.validationMessage,t.classList.add(this._errorClass)}_hideInputError(e){const t=this._form.querySelector("#"+e.id+"-error");e.classList.remove(this._inputErrorClass),t.textContent="",t.classList.remove(this._errorClass)}_checkInputValidity(e){e.validity.valid?this._hideInputError(e):this._showInputError(e)}_toggleButtonState(){let e=!1;this._inputElements.forEach((t=>{t.validity.valid||(e=!0)})),e?this.disableButton():(this._submitButton.classList.remove(this._inactiveButtonClass),this._submitButton.disabled=!1)}disableButton(){this._submitButton.classList.add(this._inactiveButtonClass),this._submitButton.disabled=!0}enableValidation(){this._form.addEventListener("submit",(e=>{e.preventDefault()})),this._setEventListeners()}_setEventListeners(){this._inputElements=[...this._form.querySelectorAll(this._inputSelector)],this._submitButton=this._form.querySelector(this._submitButtonSelector),this._inputElements.forEach((e=>{e.addEventListener("input",(t=>{this._checkInputValidity(e),this._toggleButtonState()}))}))}}const n={inputSelector:".modal__input",submitButtonSelector:".modal__button",inactiveButtonClass:"modal__button_disabled",inputErrorClass:"modal__input_type_error",errorClass:"modal__error_visible"},s=document.querySelector("#delete-card-form"),i=(document.querySelector("#modal-delete-card-close-button"),document.querySelector("#delete-card-modal"),document.querySelector("#add-card-modal").querySelector("#add-card-form")),a=document.querySelector(".header__logo-button"),l=(i.querySelector("#add-card-title-input"),i.querySelector("#add-card-description-input"),document.querySelector("#modal-add-close-button"),document.querySelector(".profile__add-button")),c=document.querySelector("#profile-edit-button"),d=document.querySelector("#profile-edit-modal"),u=document.querySelector("#profile-avatar-modal"),m=(document.querySelector("#modal-edit-close-button"),document.querySelector(".profile__title"),document.querySelector(".profile__description"),document.querySelector("#profile-title-input")),h=document.querySelector("#profile-description-input"),_=(document.querySelector(".cards__list"),d.querySelector(".modal__form")),p=u.querySelector(".modal__form"),E=(document.querySelector("#card-template").content.firstElementChild,document.querySelector("#add-image-card-modal"));function v(e){q.open(e)}function S(e){k.open(),k.setConfirmAction((()=>{j.deleteCard(e.id).then((()=>{e.removeCard(),k.close()})).catch(console.error)}))}function f(e){j.updateLikes(e.isLiked,e.id).then((()=>{e.toggleLikeIcon(),e.isLiked=!e.isLiked}))}function y(e){const t=function(e){return new r(e,"#card-template",v,S,f).getView()}(e);B.addItem(t)}E.querySelector("#add-image-card-form"),E.querySelector(".modal__close"),E.querySelector(".modal__caption"),E.querySelector(".modal__image"),document.querySelector(".modal__button"),new o(n,_).enableValidation();const L=new o(n,i);L.enableValidation();const g=new o(n,p);g.enableValidation(),new o(n,s).enableValidation();const k=new class extends e{constructor(e){super({popupSelector:e}),this._confirmButton=this._popupElement.querySelector(".modal__delete-button"),this._handleSubmitCallback=null}setConfirmAction(e){this._handleSubmitCallback=e}setEventListeners(){super.setEventListeners(),this._confirmButton.addEventListener("click",(()=>{this._handleSubmitCallback()}))}}("#delete-card-modal");k.setEventListeners();const C=new t("#profile-edit-modal",(function(e){C.renderLoading(!0),w.setUserInfo(e.title,e.description),C.close(),C.renderLoading(!1)}));C.setEventListeners();const b=new t("#add-card-modal",(function(e){const t=e.title,r=e["image-url"];b.renderLoading(!0),j.addNewCard({name:t,link:r}).then((e=>{y(e),b.close(),b.resetForm(),L.disableButton(),b.renderLoading(!1)}))}));b.setEventListeners();const q=new class extends e{constructor(e){let{popupSelector:t}=e;super({popupSelector:t}),this._modalImage=this._popupElement.querySelector(".modal__image"),this._imageCaption=this._popupElement.querySelector(".modal__caption")}open(e){this._modalImage.src=e.link,this._modalImage.alt=e.name,this._imageCaption.textContent=e.name,super.open()}}({popupSelector:"#add-image-card-modal"});q.setEventListeners();const I=new t("#profile-avatar-modal",(function(e){I.renderLoading(!0);const t=e.url;j.updateProfilePicture(t).then((()=>{w.setAvatarImage({avatar:t}),I.close(),I.resetForm(),I.preventDefault(evt),g.disableButton()})).catch((e=>{console.error("Error updatin avatar",e)})).finally((()=>{I.renderLoading(!1)}))}));I.setEventListeners();const B=new class{constructor(e){let{renderer:t,selector:r}=e;this._renderer=t,this._element=document.querySelector(r)}renderItems(e){e.forEach((e=>{this._renderer(e)}))}addItem(e){this._element.prepend(e)}}({renderer:e=>{y(e)},selector:".cards__list"}),w=new class{constructor(e){let{nameSelector:t,descriptionSelector:r,avatarSelector:o}=e;this._nameElement=document.querySelector(t),this._descriptionElement=document.querySelector(r),this._profileAvatar=document.querySelector(o)}getUserInfo(){return{name:this._nameElement.textContent,description:this._descriptionElement.textContent}}setUserInfo(e,t){this._nameElement.textContent=e,this._descriptionElement.textContent=t}setAvatarImage(e){let{avatar:t}=e;this._profileAvatar.src=t}}({nameSelector:".profile__title",descriptionSelector:".profile__description",avatarSelector:".profile__image"});c.addEventListener("click",(()=>{const e=w.getUserInfo();m.value=e.name,h.value=e.description,C.open()})),l.addEventListener("click",(()=>{b.open()})),a.addEventListener("click",(()=>{I.open()}));const j=new class{constructor(e){}getInitialCards(){return fetch("https://around-api.en.tripleten-services.com/v1/cards",{headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}getUserInfo(){return fetch("https://around-api.en.tripleten-services.com/v1/users/me",{headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df"}}).then((e=>e.json())).then((e=>{console.log(e)}))}editProfileInfo(){return fetch("https://around-api.en.tripleten-services.com/v1/users/me",{method:"PATCH",headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df","Content-Type":"application/json"},body:JSON.stringify({name:"Marie SkÅ‚odowska Curie",about:"Physicist and Chemist"})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}addNewCard(e){let{name:t,link:r}=e;return fetch("https://around-api.en.tripleten-services.com/v1/cards",{method:"POST",headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df","Content-Type":"application/json"},body:JSON.stringify({name:t,link:r})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}deleteCard(e){return fetch(`https://around-api.en.tripleten-services.com/v1/cards/${e}`,{method:"DELETE",headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df","Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}updateProfilePicture(e){return fetch("https://around-api.en.tripleten-services.com/v1/users/me/avatar",{method:"PATCH",headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df","Content-Type":"application/json"},body:JSON.stringify({avatar:e})}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}updateLikes(e,t){return fetch(`https://around-api.en.tripleten-services.com/v1/cards/${t}/likes`,{method:e?"DELETE":"PUT",headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df","Content-Type":"application/json"}}).then((e=>e.ok?e.json():Promise.reject(`Error: ${e.status}`)))}}({baseUrl:"https://around-api.en.tripleten-services.com/v1",headers:{authorization:"4e1d8109-9ece-45e8-8ccd-12c7e4a219df","Content-Type":"application/json"}});Promise.all([j.getInitialCards(),j.getUserInfo()]).then((e=>{let[t,r]=e;B.renderItems(t)}))}();
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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R0FDRkEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FHTkMsUUFBUUMsT0FBTyxVQUFVSixFQUFJSyxXQUV4QyxDQUNBL0Isb0JBQUFBLENBQXFCRSxHQUNuQixPQUFPcUIsTUFDTCxrRUFDQSxDQUNFWSxPQUFRLFFBQ1JYLFFBQVMsQ0FDUEMsY0FBZSx1Q0FDZixlQUFnQixvQkFFbEJXLEtBQU1DLEtBQUtDLFVBQVUsQ0FDbkJwQyxhQUdKN0IsTUFBTXFELEdBQ0ZBLEVBQUlDLEdBQ0NELEVBQUlFLE9BR05DLFFBQVFDLE9BQU8sVUFBVUosRUFBSUssV0FFeEMsQ0FDQXRELFdBQUFBLENBQVl6RSxFQUFTQyxHQUNuQixPQUFPc0gsTUFDTCx5REFBeUR0SCxVQUN6RCxDQUNFa0ksT0FBUW5JLEVBQVUsU0FBVyxNQUM3QndILFFBQVMsQ0FDUEMsY0FBZSx1Q0FDZixlQUFnQixzQkFHcEJwRCxNQUFNcUQsR0FDRkEsRUFBSUMsR0FDQ0QsRUFBSUUsT0FHTkMsUUFBUUMsT0FBTyxVQUFVSixFQUFJSyxXQUV4QyxHTDhIa0IsQ0FDbEJTLFFBQVMsa0RBQ1RoQixRQUFTLENBQ1BDLGNBQWUsdUNBQ2YsZUFBZ0Isc0JBa0JwQkksUUFBUVksSUFBSSxDQUFDdEUsRUFBSW1ELGtCQUFtQm5ELEVBQUkrQyxnQkFBZ0I3QyxNQUN0RHJILElBQXVCLElBQXJCMEwsRUFBT0MsR0FBUzNMLEVBQ2hCOEgsRUFBUTBCLFlBQVlrQyxFQUFNLEciLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhGb3JtLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9jb21wb25lbnRzL0NhcmQuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvdXRpbHMvY29uc3RhbnRzLmpzIiwid2VicGFjazovL3ByYWN0aWN1bS8uL3NyYy9wYWdlcy9pbmRleC5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanMiLCJ3ZWJwYWNrOi8vcHJhY3RpY3VtLy4vc3JjL2NvbXBvbmVudHMvU2VjdGlvbi5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9Vc2VySW5mby5qcyIsIndlYnBhY2s6Ly9wcmFjdGljdW0vLi9zcmMvY29tcG9uZW50cy9BcGkuanMiXSwic291cmNlc0NvbnRlbnQiOlsiZXhwb3J0IGRlZmF1bHQgY2xhc3MgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IocG9wdXBTZWxlY3Rvcik7XG4gICAgdGhpcy5fY2xvc2VCdXR0b24gPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG4gIH1cblxuICBvcGVuKCkge1xuICAgIHRoaXMuX3BvcHVwRWxlbWVudC5jbGFzc0xpc3QuYWRkKFwibW9kYWxfb3BlbmVkXCIpO1xuICAgIGRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJrZXlkb3duXCIsIHRoaXMuX2hhbmRsZUVzY2FwZSk7XG4gIH1cblxuICBjbG9zZSgpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuY2xhc3NMaXN0LnJlbW92ZShcIm1vZGFsX29wZW5lZFwiKTtcbiAgICBkb2N1bWVudC5yZW1vdmVFdmVudExpc3RlbmVyKFwia2V5ZG93blwiLCB0aGlzLl9oYW5kbGVFc2NhcGUpO1xuICB9XG5cbiAgX2hhbmRsZUVzY2FwZSA9IChldnQpID0+IHtcbiAgICBpZiAoZXZ0LmtleSA9PT0gXCJFc2NhcGVcIikge1xuICAgICAgdGhpcy5jbG9zZSgpO1xuICAgIH1cbiAgfTtcblxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICB0aGlzLl9wb3B1cEVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcihcIm1vdXNlZG93blwiLCAoZXZ0KSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIGV2dC50YXJnZXQuY2xhc3NMaXN0LmNvbnRhaW5zKFwibW9kYWxcIikgfHxcbiAgICAgICAgZXZ0LnRhcmdldC5jbGFzc0xpc3QuY29udGFpbnMoXCJtb2RhbF9fY2xvc2VcIilcbiAgICAgICkge1xuICAgICAgICB0aGlzLmNsb3NlKCk7XG4gICAgICB9XG4gICAgfSk7XG4gICAgLy90aGlzLl9jbG9zZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgIC8vIHRoaXMuY2xvc2UoKTtcbiAgICAvLyB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEZvcm0gZXh0ZW5kcyBQb3B1cCB7XG4gIGNvbnN0cnVjdG9yKHBvcHVwU2VsZWN0b3IsIGhhbmRsZUZvcm1TdWJtaXQpIHtcbiAgICBzdXBlcih7IHBvcHVwU2VsZWN0b3IgfSk7XG4gICAgdGhpcy5faGFuZGxlRm9ybVN1Ym1pdCA9IGhhbmRsZUZvcm1TdWJtaXQ7XG4gICAgdGhpcy5fZm9ybUVsZW1lbnQgPSB0aGlzLl9wb3B1cEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoXCIubW9kYWxfX2lucHV0XCIpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19idXR0b25cIik7XG4gIH1cbiAgX2dldElucHV0VmFsdWVzKCkge1xuICAgIGNvbnN0IGlucHV0VmFsdWVzID0ge307XG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dCkgPT4ge1xuICAgICAgaW5wdXRWYWx1ZXNbaW5wdXQubmFtZV0gPSBpbnB1dC52YWx1ZTtcbiAgICB9KTtcblxuICAgIHJldHVybiBpbnB1dFZhbHVlcztcbiAgfVxuICBzZXRFdmVudExpc3RlbmVycygpIHtcbiAgICBzdXBlci5zZXRFdmVudExpc3RlbmVycygpO1xuICAgIHRoaXMuX2Zvcm1FbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJzdWJtaXRcIiwgKGV2dCkgPT4ge1xuICAgICAgZXZ0LnByZXZlbnREZWZhdWx0KCk7XG4gICAgICB0aGlzLl9oYW5kbGVGb3JtU3VibWl0KHRoaXMuX2dldElucHV0VmFsdWVzKCkpO1xuICAgIH0pO1xuICB9XG4gIHJlc2V0Rm9ybSgpIHtcbiAgICB0aGlzLl9mb3JtRWxlbWVudC5yZXNldCgpO1xuICB9XG4gIHJlbmRlckxvYWRpbmcoaXNMb2FkaW5nKSB7XG4gICAgaWYgKGlzTG9hZGluZykge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZpbmcuLi5cIjtcbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5fc3VibWl0QnV0dG9uLnRleHRDb250ZW50ID0gXCJTYXZlLi4uXCI7XG4gICAgfVxuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBDYXJkIHtcbiAgY29uc3RydWN0b3IoXG4gICAgZGF0YSxcbiAgICBjYXJkU2VsZWN0b3IsXG4gICAgaGFuZGxlSW1hZ2VDbGljayxcbiAgICBoYW5kbGVEZWxldGVDbGljayxcbiAgICBoYW5kbGVMaWtlQ2xpY2tcbiAgKSB7XG4gICAgdGhpcy5uYW1lID0gZGF0YS5uYW1lO1xuICAgIHRoaXMubGluayA9IGRhdGEubGluaztcbiAgICB0aGlzLl9kYXRhID0gZGF0YTtcbiAgICB0aGlzLmlzTGlrZWQgPSBkYXRhLmlzTGlrZWQ7XG4gICAgdGhpcy5pZCA9IGRhdGEuX2lkO1xuICAgIHRoaXMuX2NhcmRTZWxlY3RvciA9IGNhcmRTZWxlY3RvcjtcbiAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrID0gaGFuZGxlSW1hZ2VDbGljaztcbiAgICB0aGlzLl9oYW5kbGVEZWxldGVDbGljayA9IGhhbmRsZURlbGV0ZUNsaWNrO1xuICAgIHRoaXMuX2hhbmRsZUxpa2VDbGljayA9IGhhbmRsZUxpa2VDbGljaztcbiAgfVxuICBfc2V0RXZlbnRMaXN0ZW5lcnMoKSB7XG4gICAgLy9cIi5jYXJkX19saWtlLWJ1dHRvblwiXG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlTGlrZUNsaWNrKHRoaXMpO1xuICAgIH0pO1xuXG4gICAgLy9cIi5jYXJkX19kZWxldGUtYnV0dG9uXCJcbiAgICB0aGlzLl9jYXJkRWxlbWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fZGVsZXRlLWJ1dHRvblwiKVxuICAgICAgLmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICAgIHRoaXMuX2hhbmRsZURlbGV0ZUNsaWNrKHRoaXMpO1xuICAgICAgfSk7XG5cbiAgICB0aGlzLl9jYXJkSW1hZ2VFbGVtZW50LmFkZEV2ZW50TGlzdGVuZXIoXCJjbGlja1wiLCAoKSA9PiB7XG4gICAgICB0aGlzLl9oYW5kbGVJbWFnZUNsaWNrKHRoaXMuX2RhdGEpO1xuICAgIH0pO1xuICB9XG4gIHJlbW92ZUNhcmQoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQucmVtb3ZlKCk7XG4gIH1cbiAgdG9nZ2xlTGlrZUljb24gPSAoKSA9PiB7XG4gICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICB9O1xuXG4gIGdldFZpZXcoKSB7XG4gICAgdGhpcy5fY2FyZEVsZW1lbnQgPSBkb2N1bWVudFxuICAgICAgLnF1ZXJ5U2VsZWN0b3IodGhpcy5fY2FyZFNlbGVjdG9yKVxuICAgICAgLmNvbnRlbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkXCIpXG4gICAgICAuY2xvbmVOb2RlKHRydWUpO1xuXG4gICAgdGhpcy5fbGlrZUJ1dHRvbiA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9fbGlrZS1idXR0b25cIik7XG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudCA9IHRoaXMuX2NhcmRFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIuY2FyZF9faW1hZ2VcIik7XG4gICAgdGhpcy5fY2FyZFRpdGxlID0gdGhpcy5fY2FyZEVsZW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkX190aXRsZVwiKTtcbiAgICB0aGlzLl9jYXJkVGl0bGUudGV4dENvbnRlbnQgPSB0aGlzLm5hbWU7XG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5hbHQgPSB0aGlzLm5hbWU7XG4gICAgdGhpcy5fY2FyZEltYWdlRWxlbWVudC5zcmMgPSB0aGlzLmxpbms7XG4gICAgaWYgKHRoaXMuaXNMaWtlZCkge1xuICAgICAgdGhpcy5fbGlrZUJ1dHRvbi5jbGFzc0xpc3QudG9nZ2xlKFwiY2FyZF9fbGlrZS1idXR0b25fYWN0aXZlXCIpO1xuICAgIH1cblxuICAgIHRoaXMuX3NldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgLy9yZXR1cm4gdGhlIGNhcmRcbiAgICByZXR1cm4gdGhpcy5fY2FyZEVsZW1lbnQ7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIEZvcm1WYWxpZGF0b3Ige1xuICBjb25zdHJ1Y3Rvcih2YWxpZGF0aW9uU2V0dGluZ3MsIGZvcm1FbGVtZW50KSB7XG4gICAgdGhpcy5fZm9ybSA9IGZvcm1FbGVtZW50O1xuICAgIHRoaXMuX2lucHV0U2VsZWN0b3IgPSB2YWxpZGF0aW9uU2V0dGluZ3MuaW5wdXRTZWxlY3RvcjtcbiAgICB0aGlzLl9zdWJtaXRCdXR0b25TZWxlY3RvciA9IHZhbGlkYXRpb25TZXR0aW5ncy5zdWJtaXRCdXR0b25TZWxlY3RvcjtcbiAgICB0aGlzLl9pbmFjdGl2ZUJ1dHRvbkNsYXNzID0gdmFsaWRhdGlvblNldHRpbmdzLmluYWN0aXZlQnV0dG9uQ2xhc3M7XG4gICAgdGhpcy5faW5wdXRFcnJvckNsYXNzID0gdmFsaWRhdGlvblNldHRpbmdzLmlucHV0RXJyb3JDbGFzcztcbiAgICB0aGlzLl9lcnJvckNsYXNzID0gdmFsaWRhdGlvblNldHRpbmdzLmVycm9yQ2xhc3M7XG4gIH1cbiAgX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudHMpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiI1wiICsgaW5wdXRFbGVtZW50cy5pZCArIFwiLWVycm9yXCJcbiAgICApO1xuICAgIGlucHV0RWxlbWVudHMuY2xhc3NMaXN0LmFkZCh0aGlzLl9pbnB1dEVycm9yQ2xhc3MpO1xuICAgIGVycm9yTWVzc2FnZUVsLnRleHRDb250ZW50ID0gaW5wdXRFbGVtZW50cy52YWxpZGF0aW9uTWVzc2FnZTtcbiAgICBlcnJvck1lc3NhZ2VFbC5jbGFzc0xpc3QuYWRkKHRoaXMuX2Vycm9yQ2xhc3MpO1xuICB9XG4gIF9oaWRlSW5wdXRFcnJvcihpbnB1dEVsZW1lbnQpIHtcbiAgICBjb25zdCBlcnJvck1lc3NhZ2VFbCA9IHRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvcihcbiAgICAgIFwiI1wiICsgaW5wdXRFbGVtZW50LmlkICsgXCItZXJyb3JcIlxuICAgICk7XG4gICAgaW5wdXRFbGVtZW50LmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5wdXRFcnJvckNsYXNzKTtcbiAgICBlcnJvck1lc3NhZ2VFbC50ZXh0Q29udGVudCA9IFwiXCI7XG4gICAgZXJyb3JNZXNzYWdlRWwuY2xhc3NMaXN0LnJlbW92ZSh0aGlzLl9lcnJvckNsYXNzKTtcbiAgfVxuXG4gIF9jaGVja0lucHV0VmFsaWRpdHkoaW5wdXRFbGVtZW50KSB7XG4gICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgIHRoaXMuX3Nob3dJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfSBlbHNlIHtcbiAgICAgIHRoaXMuX2hpZGVJbnB1dEVycm9yKGlucHV0RWxlbWVudCk7XG4gICAgfVxuICB9XG4gIF90b2dnbGVCdXR0b25TdGF0ZSgpIHtcbiAgICBsZXQgZm91bmRJbnZhbGlkID0gZmFsc2U7XG5cbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzLmZvckVhY2goKGlucHV0RWxlbWVudCkgPT4ge1xuICAgICAgaWYgKCFpbnB1dEVsZW1lbnQudmFsaWRpdHkudmFsaWQpIHtcbiAgICAgICAgZm91bmRJbnZhbGlkID0gdHJ1ZTtcbiAgICAgIH1cbiAgICB9KTtcbiAgICBpZiAoZm91bmRJbnZhbGlkKSB7XG4gICAgICB0aGlzLmRpc2FibGVCdXR0b24oKTtcbiAgICAgIHJldHVybjtcbiAgICB9XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmNsYXNzTGlzdC5yZW1vdmUodGhpcy5faW5hY3RpdmVCdXR0b25DbGFzcyk7XG4gICAgdGhpcy5fc3VibWl0QnV0dG9uLmRpc2FibGVkID0gZmFsc2U7XG4gIH1cblxuICBkaXNhYmxlQnV0dG9uKCkge1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5jbGFzc0xpc3QuYWRkKHRoaXMuX2luYWN0aXZlQnV0dG9uQ2xhc3MpO1xuICAgIHRoaXMuX3N1Ym1pdEJ1dHRvbi5kaXNhYmxlZCA9IHRydWU7XG4gIH1cblxuICBlbmFibGVWYWxpZGF0aW9uKCkge1xuICAgIHRoaXMuX2Zvcm0uYWRkRXZlbnRMaXN0ZW5lcihcInN1Ym1pdFwiLCAoZXZ0KSA9PiB7XG4gICAgICBldnQucHJldmVudERlZmF1bHQoKTtcbiAgICB9KTtcbiAgICB0aGlzLl9zZXRFdmVudExpc3RlbmVycygpO1xuICB9XG5cbiAgX3NldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIC8vIGNvbnN0IHsgaW5wdXRTZWxlY3RvciB9ID0gb3B0aW9ucztcbiAgICB0aGlzLl9pbnB1dEVsZW1lbnRzID0gWy4uLnRoaXMuX2Zvcm0ucXVlcnlTZWxlY3RvckFsbCh0aGlzLl9pbnB1dFNlbGVjdG9yKV07XG5cbiAgICB0aGlzLl9zdWJtaXRCdXR0b24gPSB0aGlzLl9mb3JtLnF1ZXJ5U2VsZWN0b3IodGhpcy5fc3VibWl0QnV0dG9uU2VsZWN0b3IpO1xuXG4gICAgdGhpcy5faW5wdXRFbGVtZW50cy5mb3JFYWNoKChpbnB1dEVsZW1lbnQpID0+IHtcbiAgICAgIGlucHV0RWxlbWVudC5hZGRFdmVudExpc3RlbmVyKFwiaW5wdXRcIiwgKGUpID0+IHtcbiAgICAgICAgdGhpcy5fY2hlY2tJbnB1dFZhbGlkaXR5KGlucHV0RWxlbWVudCk7XG4gICAgICAgIHRoaXMuX3RvZ2dsZUJ1dHRvblN0YXRlKCk7XG4gICAgICB9KTtcbiAgICB9KTtcbiAgfVxufVxuIiwiZXhwb3J0IGNvbnN0IGluaXRpYWxDYXJkcyA9IFtcbiAge1xuICAgIG5hbWU6IFwiWW9zZW1pdGUgVmFsbGV5XCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L3lvc2VtaXRlLmpwZ1wiLFxuICB9LFxuXG4gIHtcbiAgICBuYW1lOiBcIkxha2UgTG91aXNlXCIsXG4gICAgbGluazogXCJodHRwczovL3ByYWN0aWN1bS1jb250ZW50LnMzLnVzLXdlc3QtMS5hbWF6b25hd3MuY29tL3NvZnR3YXJlLWVuZ2luZWVyL2Fyb3VuZC1wcm9qZWN0L2xha2UtbG91aXNlLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJCYWxkIE1vdW50YWluc1wiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9iYWxkLW1vdW50YWlucy5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGF0ZW1hclwiLFxuICAgIGxpbms6IFwiaHR0cHM6Ly9wcmFjdGljdW0tY29udGVudC5zMy51cy13ZXN0LTEuYW1hem9uYXdzLmNvbS9zb2Z0d2FyZS1lbmdpbmVlci9hcm91bmQtcHJvamVjdC9sYXRlbWFyLmpwZ1wiLFxuICB9LFxuICB7XG4gICAgbmFtZTogXCJWYW5vaXNlIE5hdGlvbmFsIFBhcmtcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvdmFub2lzZS5qcGdcIixcbiAgfSxcbiAge1xuICAgIG5hbWU6IFwiTGFnbyBkaSBCcmFpZXNcIixcbiAgICBsaW5rOiBcImh0dHBzOi8vcHJhY3RpY3VtLWNvbnRlbnQuczMudXMtd2VzdC0xLmFtYXpvbmF3cy5jb20vc29mdHdhcmUtZW5naW5lZXIvYXJvdW5kLXByb2plY3QvbGFnby5qcGdcIixcbiAgfSxcbl07XG5cbmV4cG9ydCBjb25zdCB2YWxpZGF0aW9uU2V0dGluZ3MgPSB7XG4gIGlucHV0U2VsZWN0b3I6IFwiLm1vZGFsX19pbnB1dFwiLFxuICBzdWJtaXRCdXR0b25TZWxlY3RvcjogXCIubW9kYWxfX2J1dHRvblwiLFxuICBpbmFjdGl2ZUJ1dHRvbkNsYXNzOiBcIm1vZGFsX19idXR0b25fZGlzYWJsZWRcIixcbiAgaW5wdXRFcnJvckNsYXNzOiBcIm1vZGFsX19pbnB1dF90eXBlX2Vycm9yXCIsXG4gIGVycm9yQ2xhc3M6IFwibW9kYWxfX2Vycm9yX3Zpc2libGVcIixcbn07XG4iLCJpbXBvcnQgUG9wdXBXaXRoSW1hZ2UgZnJvbSBcIi4uL2NvbXBvbmVudHMvUG9wdXBXaXRoSW1hZ2UuanNcIjtcbmltcG9ydCBQb3B1cFdpdGhGb3JtIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwV2l0aEZvcm0uanNcIjtcbmltcG9ydCBVc2VySW5mbyBmcm9tIFwiLi4vY29tcG9uZW50cy9Vc2VySW5mby5qc1wiO1xuaW1wb3J0IFNlY3Rpb24gZnJvbSBcIi4uL2NvbXBvbmVudHMvU2VjdGlvbi5qc1wiO1xuaW1wb3J0IENhcmQgZnJvbSBcIi4uL2NvbXBvbmVudHMvQ2FyZC5qc1wiO1xuaW1wb3J0IEZvcm1WYWxpZGF0b3IgZnJvbSBcIi4uL2NvbXBvbmVudHMvRm9ybVZhbGlkYXRvci5qc1wiO1xuaW1wb3J0IFBvcHVwV2l0aENvbmZpcm1hdGlvbiBmcm9tIFwiLi4vY29tcG9uZW50cy9Qb3B1cFdpdGhDb25maXJtYXRpb24uanNcIjtcbmltcG9ydCBcIi4vaW5kZXguY3NzXCI7XG5pbXBvcnQgeyBpbml0aWFsQ2FyZHMsIHZhbGlkYXRpb25TZXR0aW5ncyB9IGZyb20gXCIuLi91dGlscy9jb25zdGFudHMuanNcIjtcbmltcG9ydCBBcGkgZnJvbSBcIi4uL2NvbXBvbmVudHMvQXBpLmpzXCI7XG5cbmNvbnN0IGRlbGV0ZUNhcmRGb3JtID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNkZWxldGUtY2FyZC1mb3JtXCIpO1xuXG5jb25zdCBkZWxldGVDYXJkQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjbW9kYWwtZGVsZXRlLWNhcmQtY2xvc2UtYnV0dG9uXCJcbik7XG5jb25zdCBkZWxldGVDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2RlbGV0ZS1jYXJkLW1vZGFsXCIpO1xuY29uc3QgYWRkQ2FyZE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNhZGQtY2FyZC1tb2RhbFwiKTtcbmNvbnN0IGFkZENhcmRGb3JtRWxlbWVudCA9IGFkZENhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1jYXJkLWZvcm1cIik7XG5jb25zdCBlZGl0QXZhdGFyQnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5oZWFkZXJfX2xvZ28tYnV0dG9uXCIpO1xuXG5jb25zdCBjYXJkVGl0bGVJbnB1dCA9IGFkZENhcmRGb3JtRWxlbWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNhZGQtY2FyZC10aXRsZS1pbnB1dFwiXG4pO1xuY29uc3QgY2FyZERlc2NyaXB0aW9uSW5wdXQgPSBhZGRDYXJkRm9ybUVsZW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjYWRkLWNhcmQtZGVzY3JpcHRpb24taW5wdXRcIlxuKTtcbmNvbnN0IGFkZENhcmRDbG9zZUJ1dHRvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjbW9kYWwtYWRkLWNsb3NlLWJ1dHRvblwiKTtcbmNvbnN0IGFkZE5ld0NhcmRCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiLnByb2ZpbGVfX2FkZC1idXR0b25cIik7XG5cbmNvbnN0IHByb2ZpbGVFZGl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWVkaXQtYnV0dG9uXCIpO1xuY29uc3QgcHJvZmlsZUVkaXRNb2RhbCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS1lZGl0LW1vZGFsXCIpO1xuY29uc3QgYXZhdGFyRWRpdE1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIiNwcm9maWxlLWF2YXRhci1tb2RhbFwiKTtcbmNvbnN0IGVkaXRQcm9maWxlQ2xvc2VCdXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFxuICBcIiNtb2RhbC1lZGl0LWNsb3NlLWJ1dHRvblwiXG4pO1xuY29uc3QgcHJvZmlsZVRpdGxlID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5wcm9maWxlX190aXRsZVwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbiA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIucHJvZmlsZV9fZGVzY3JpcHRpb25cIik7XG5jb25zdCBwcm9maWxlVGl0bGVJbnB1dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoXCIjcHJvZmlsZS10aXRsZS1pbnB1dFwiKTtcbmNvbnN0IHByb2ZpbGVEZXNjcmlwdGlvbklucHV0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcbiAgXCIjcHJvZmlsZS1kZXNjcmlwdGlvbi1pbnB1dFwiXG4pO1xuXG5jb25zdCBjYXJkTGlzdEVsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5jYXJkc19fbGlzdFwiKTtcbmNvbnN0IHByb2ZpbGVFZGl0Rm9ybSA9IHByb2ZpbGVFZGl0TW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fZm9ybVwiKTtcbmNvbnN0IGF2YXRhckVkaXRGb3JtID0gYXZhdGFyRWRpdE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2Zvcm1cIik7XG5jb25zdCBjYXJkVGVtcGxhdGUgPVxuICBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2NhcmQtdGVtcGxhdGVcIikuY29udGVudC5maXJzdEVsZW1lbnRDaGlsZDtcblxuY29uc3QgYWRkSW1hZ2VDYXJkTW9kYWwgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKFwiI2FkZC1pbWFnZS1jYXJkLW1vZGFsXCIpO1xuY29uc3QgYWRkSW1hZ2VDYXJkRm9ybSA9IGFkZEltYWdlQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXG4gIFwiI2FkZC1pbWFnZS1jYXJkLWZvcm1cIlxuKTtcbmNvbnN0IGFkZEltYWdlQ2FyZENsb3NlQnV0dG9uID1cbiAgYWRkSW1hZ2VDYXJkTW9kYWwucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fY2xvc2VcIik7XG5jb25zdCBpbWFnZUNhcHRpb24gPSBhZGRJbWFnZUNhcmRNb2RhbC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xuY29uc3QgbW9kYWxJbWFnZSA9IGFkZEltYWdlQ2FyZE1vZGFsLnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuXG4vLyBmdW5jdGlvbiBoYW5kbGVFc2NhcGUoZXZ0KSB7XG4vLyAgIGlmIChldnQua2V5ID09PSBcIkVzY2FwZVwiKSB7XG4vLyAgICAgY29uc3Qgb3Blbk1vZGFsID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9vcGVuZWRcIik7XG4vLyAgICAgaWYgKG9wZW5Nb2RhbCkge1xuLy8gICAgICAgY2xvc2VQb3B1cChvcGVuTW9kYWwpO1xuLy8gICAgIH1cbi8vICAgfVxuLy8gfVxuXG5mdW5jdGlvbiBoYW5kbGVDYXJkQ2xpY2soZGF0YSkge1xuICBwb3B1cFdpdGhJbWFnZS5vcGVuKGRhdGEpO1xufVxuXG5mdW5jdGlvbiBoYW5kbGVQcm9maWxlRWRpdFN1Ym1pdChpbnB1dFZhbHVlcykge1xuICBwb3B1cEVkaXRXaXRoRm9ybS5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICB1c2VySW5mby5zZXRVc2VySW5mbyhpbnB1dFZhbHVlcy50aXRsZSwgaW5wdXRWYWx1ZXMuZGVzY3JpcHRpb24pO1xuICBwb3B1cEVkaXRXaXRoRm9ybS5jbG9zZSgpO1xuICBwb3B1cEVkaXRXaXRoRm9ybS5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2xpY2soY2FyZCkge1xuICBwb3B1cERlbGV0ZVdpdGhGb3JtLm9wZW4oKTtcbiAgcG9wdXBEZWxldGVXaXRoRm9ybS5zZXRDb25maXJtQWN0aW9uKCgpID0+IHtcbiAgICBhcGlcbiAgICAgIC5kZWxldGVDYXJkKGNhcmQuaWQpXG4gICAgICAudGhlbigoKSA9PiB7XG4gICAgICAgIGNhcmQucmVtb3ZlQ2FyZCgpO1xuICAgICAgICBwb3B1cERlbGV0ZVdpdGhGb3JtLmNsb3NlKCk7XG4gICAgICB9KVxuICAgICAgLmNhdGNoKGNvbnNvbGUuZXJyb3IpO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlQWRkQ2FyZEZvcm1TdWJtaXQoaW5wdXRWYWx1ZXMpIHtcbiAgY29uc3QgbmFtZSA9IGlucHV0VmFsdWVzLnRpdGxlO1xuICBjb25zdCBsaW5rID0gaW5wdXRWYWx1ZXNbXCJpbWFnZS11cmxcIl07XG4gIHBvcHVwQWRkV2l0aEZvcm0ucmVuZGVyTG9hZGluZyh0cnVlKTtcbiAgYXBpLmFkZE5ld0NhcmQoeyBuYW1lLCBsaW5rIH0pLnRoZW4oKGRhdGEpID0+IHtcbiAgICByZW5kZXJDYXJkKGRhdGEpO1xuICAgIHBvcHVwQWRkV2l0aEZvcm0uY2xvc2UoKTtcbiAgICBwb3B1cEFkZFdpdGhGb3JtLnJlc2V0Rm9ybSgpO1xuICAgIGFkZEZvcm1WYWxpZGF0b3IuZGlzYWJsZUJ1dHRvbigpO1xuICAgIHBvcHVwQWRkV2l0aEZvcm0ucmVuZGVyTG9hZGluZyhmYWxzZSk7XG4gIH0pO1xufVxuXG4vL2NvbnN0IGFhYSA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKFwiYWFhXCIpO1xuXG5mdW5jdGlvbiBoYW5kbGVBdmF0YXJGb3JtU3VibWl0KGRhdGEpIHtcbiAgcG9wdXBBdmF0YXJFZGl0Rm9ybS5yZW5kZXJMb2FkaW5nKHRydWUpO1xuICBjb25zdCB1cmwgPSBkYXRhLnVybDtcbiAgYXBpXG4gICAgLnVwZGF0ZVByb2ZpbGVQaWN0dXJlKHVybClcbiAgICAudGhlbigoKSA9PiB7XG4gICAgICB1c2VySW5mby5zZXRBdmF0YXJJbWFnZSh7IGF2YXRhcjogdXJsIH0pO1xuICAgICAgcG9wdXBBdmF0YXJFZGl0Rm9ybS5jbG9zZSgpO1xuICAgICAgcG9wdXBBdmF0YXJFZGl0Rm9ybS5yZXNldEZvcm0oKTtcbiAgICAgIHBvcHVwQXZhdGFyRWRpdEZvcm0ucHJldmVudERlZmF1bHQoZXZ0KTtcbiAgICAgIGVkaXRBdmF0YXJWYWxpZGF0b3IuZGlzYWJsZUJ1dHRvbigpO1xuICAgIH0pXG4gICAgLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHVwZGF0aW4gYXZhdGFyXCIsIGVycm9yKTtcbiAgICB9KVxuICAgIC5maW5hbGx5KCgpID0+IHtcbiAgICAgIC8vIFB1dCByZW5kaW5nIGxvYWRpbmcgZmFsc2UgaGVyZVxuICAgICAgcG9wdXBBdmF0YXJFZGl0Rm9ybS5yZW5kZXJMb2FkaW5nKGZhbHNlKTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gaGFuZGxlRGVsZXRlQ2FyZFN1Ym1pdCgpIHtcbiAgYXBpLmRlbGV0ZUNhcmQoKCkgPT4ge1xuICAgIGRlbGV0ZUNhcmRCdXR0b24uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcbiAgfSk7XG59XG5cbmNvbnN0IG1vZGFsU3VibWl0QnV0dG9uID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcihcIi5tb2RhbF9fYnV0dG9uXCIpO1xuXG5mdW5jdGlvbiBjcmVhdGVDYXJkKGNhcmREYXRhKSB7XG4gIGNvbnN0IGNhcmQgPSBuZXcgQ2FyZChcbiAgICBjYXJkRGF0YSxcbiAgICBcIiNjYXJkLXRlbXBsYXRlXCIsXG4gICAgaGFuZGxlQ2FyZENsaWNrLFxuICAgIGhhbmRsZURlbGV0ZUNsaWNrLFxuICAgIGhhbmRsZUxpa2VDbGlja1xuICApO1xuICByZXR1cm4gY2FyZC5nZXRWaWV3KCk7XG59XG5cbmZ1bmN0aW9uIGhhbmRsZUxpa2VDbGljayhjYXJkKSB7XG4gIGFwaS51cGRhdGVMaWtlcyhjYXJkLmlzTGlrZWQsIGNhcmQuaWQpLnRoZW4oKCkgPT4ge1xuICAgIGNhcmQudG9nZ2xlTGlrZUljb24oKTtcbiAgICBjYXJkLmlzTGlrZWQgPSAhY2FyZC5pc0xpa2VkO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gcmVuZGVyQ2FyZChjYXJkRGF0YSkge1xuICAvLyBjb25zdCBjYXJkRWxlbWVudCA9IGdldENhcmRFbGVtZW50KGNhcmREYXRhKTtcblxuICBjb25zdCBjYXJkRWxlbWVudCA9IGNyZWF0ZUNhcmQoY2FyZERhdGEpO1xuICBzZWN0aW9uLmFkZEl0ZW0oY2FyZEVsZW1lbnQpO1xuICAvLyBjYXJkTGlzdEVsLnByZXBlbmQoY2FyZEVsZW1lbnQpO1xufVxuXG5jb25zdCBlZGl0Rm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICB2YWxpZGF0aW9uU2V0dGluZ3MsXG4gIHByb2ZpbGVFZGl0Rm9ybVxuKTtcbmVkaXRGb3JtVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgYWRkRm9ybVZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICB2YWxpZGF0aW9uU2V0dGluZ3MsXG4gIGFkZENhcmRGb3JtRWxlbWVudFxuKTtcbmFkZEZvcm1WYWxpZGF0b3IuZW5hYmxlVmFsaWRhdGlvbigpO1xuXG5jb25zdCBlZGl0QXZhdGFyVmFsaWRhdG9yID0gbmV3IEZvcm1WYWxpZGF0b3IoXG4gIHZhbGlkYXRpb25TZXR0aW5ncyxcbiAgYXZhdGFyRWRpdEZvcm1cbik7XG5lZGl0QXZhdGFyVmFsaWRhdG9yLmVuYWJsZVZhbGlkYXRpb24oKTtcblxuY29uc3QgZGVsZXRlQ2FyZFZhbGlkYXRvciA9IG5ldyBGb3JtVmFsaWRhdG9yKFxuICB2YWxpZGF0aW9uU2V0dGluZ3MsXG4gIGRlbGV0ZUNhcmRGb3JtXG4pO1xuZGVsZXRlQ2FyZFZhbGlkYXRvci5lbmFibGVWYWxpZGF0aW9uKCk7XG5cbmNvbnN0IHBvcHVwRGVsZXRlV2l0aEZvcm0gPSBuZXcgUG9wdXBXaXRoQ29uZmlybWF0aW9uKFwiI2RlbGV0ZS1jYXJkLW1vZGFsXCIpO1xucG9wdXBEZWxldGVXaXRoRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBwb3B1cEVkaXRXaXRoRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuICBcIiNwcm9maWxlLWVkaXQtbW9kYWxcIixcbiAgaGFuZGxlUHJvZmlsZUVkaXRTdWJtaXRcbik7XG5wb3B1cEVkaXRXaXRoRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBwb3B1cEFkZFdpdGhGb3JtID0gbmV3IFBvcHVwV2l0aEZvcm0oXG4gIFwiI2FkZC1jYXJkLW1vZGFsXCIsXG4gIGhhbmRsZUFkZENhcmRGb3JtU3VibWl0XG4pO1xucG9wdXBBZGRXaXRoRm9ybS5zZXRFdmVudExpc3RlbmVycygpO1xuXG5jb25zdCBwb3B1cFdpdGhJbWFnZSA9IG5ldyBQb3B1cFdpdGhJbWFnZSh7XG4gIHBvcHVwU2VsZWN0b3I6IFwiI2FkZC1pbWFnZS1jYXJkLW1vZGFsXCIsXG59KTtcbnBvcHVwV2l0aEltYWdlLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHBvcHVwQXZhdGFyRWRpdEZvcm0gPSBuZXcgUG9wdXBXaXRoRm9ybShcbiAgXCIjcHJvZmlsZS1hdmF0YXItbW9kYWxcIixcbiAgaGFuZGxlQXZhdGFyRm9ybVN1Ym1pdFxuKTtcbnBvcHVwQXZhdGFyRWRpdEZvcm0uc2V0RXZlbnRMaXN0ZW5lcnMoKTtcblxuLy8gY29uc3QgcG9wdXBEZWxldGVDYXJkRm9ybSA9IG5ldyBQb3B1cFdpdGhGb3JtKFxuLy8gICBcIiNkZWxldGUtY2FyZC1tb2RhbFwiXG4vLyAgIC8vaGFuZGxlRGVcbi8vICk7XG4vLyBwb3B1cERlbGV0ZUNhcmRGb3JtLnNldEV2ZW50TGlzdGVuZXJzKCk7XG5cbmNvbnN0IHNlY3Rpb24gPSBuZXcgU2VjdGlvbih7XG4gIHJlbmRlcmVyOiAoaXRlbSkgPT4ge1xuICAgIC8vIGNvbnN0IGNhcmQgPSBjcmVhdGVDYXJkKGl0ZW0pO1xuXG4gICAgLy8gc2VjdGlvbi5hZGRJdGVtKGNhcmQpO1xuICAgIHJlbmRlckNhcmQoaXRlbSk7XG4gIH0sXG4gIHNlbGVjdG9yOiBcIi5jYXJkc19fbGlzdFwiLFxufSk7XG5cbmNvbnN0IHVzZXJJbmZvID0gbmV3IFVzZXJJbmZvKHtcbiAgbmFtZVNlbGVjdG9yOiBcIi5wcm9maWxlX190aXRsZVwiLFxuICBkZXNjcmlwdGlvblNlbGVjdG9yOiBcIi5wcm9maWxlX19kZXNjcmlwdGlvblwiLFxuICBhdmF0YXJTZWxlY3RvcjogXCIucHJvZmlsZV9faW1hZ2VcIixcbn0pO1xuXG5wcm9maWxlRWRpdEJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBjb25zdCBpbmZvID0gdXNlckluZm8uZ2V0VXNlckluZm8oKTtcbiAgcHJvZmlsZVRpdGxlSW5wdXQudmFsdWUgPSBpbmZvLm5hbWU7XG4gIHByb2ZpbGVEZXNjcmlwdGlvbklucHV0LnZhbHVlID0gaW5mby5kZXNjcmlwdGlvbjtcbiAgcG9wdXBFZGl0V2l0aEZvcm0ub3BlbigpO1xufSk7XG5cbmFkZE5ld0NhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbiAgcG9wdXBBZGRXaXRoRm9ybS5vcGVuKCk7XG59KTtcblxuZWRpdEF2YXRhckJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICBwb3B1cEF2YXRhckVkaXRGb3JtLm9wZW4oKTtcbn0pO1xuXG4vL2RlbGV0ZUNhcmRCdXR0b24uYWRkRXZlbnRMaXN0ZW5lcihcImNsaWNrXCIsICgpID0+IHtcbi8vcG9wdXBEZWxldGVXaXRoRm9ybS5vcGVuKCk7XG4vL30pO1xuLy8gaW5zdGFudGlhdGUgQVBJXG5jb25zdCBhcGkgPSBuZXcgQXBpKHtcbiAgYmFzZVVybDogXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MVwiLFxuICBoZWFkZXJzOiB7XG4gICAgYXV0aG9yaXphdGlvbjogXCI0ZTFkODEwOS05ZWNlLTQ1ZTgtOGNjZC0xMmM3ZTRhMjE5ZGZcIixcbiAgICBcIkNvbnRlbnQtVHlwZVwiOiBcImFwcGxpY2F0aW9uL2pzb25cIixcbiAgfSxcbn0pO1xuXG4vLyBhcGlcbi8vICAgLmdldEluaXRpYWxDYXJkcygpXG4vLyAgIC50aGVuKChkYXRhKSA9PiB7XG4vLyAgICAgLy8gZGF0YSB3aWxsIGJlIGFuIGFycmF5IHdpdGggMSBjYXJkIGluIGl0XG4vLyAgIH0pXG4vLyAgIC5jYXRjaCgoZXJyKSA9PiB7fSk7XG5cbi8vIGFwaVxuLy8gICAuZ2V0VXNlckluZm8oKVxuLy8gICAudGhlbigoZGF0YSkgPT4ge1xuLy8gICAgIC8vIGRhdGEgd2lsbCBiZSBhbiBhcnJheSB3aXRoIDEgY2FyZCBpbiBpdFxuLy8gICB9KVxuLy8gICAuY2F0Y2goKGVycikgPT4ge30pO1xuXG5Qcm9taXNlLmFsbChbYXBpLmdldEluaXRpYWxDYXJkcygpLCBhcGkuZ2V0VXNlckluZm8oKV0pLnRoZW4oXG4gIChbY2FyZHMsIHVzZXJEYXRhXSkgPT4ge1xuICAgIHNlY3Rpb24ucmVuZGVySXRlbXMoY2FyZHMpO1xuICB9XG4pO1xuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuL1BvcHVwXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aENvbmZpcm1hdGlvbiBleHRlbmRzIFBvcHVwIHtcbiAgY29uc3RydWN0b3IocG9wdXBTZWxlY3Rvcikge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9jb25maXJtQnV0dG9uID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXG4gICAgICBcIi5tb2RhbF9fZGVsZXRlLWJ1dHRvblwiXG4gICAgKTtcbiAgICB0aGlzLl9oYW5kbGVTdWJtaXRDYWxsYmFjayA9IG51bGw7XG4gIH1cblxuICBzZXRDb25maXJtQWN0aW9uKGNhbGxiYWNrKSB7XG4gICAgdGhpcy5faGFuZGxlU3VibWl0Q2FsbGJhY2sgPSBjYWxsYmFjaztcbiAgfVxuXG4gIHNldEV2ZW50TGlzdGVuZXJzKCkge1xuICAgIHN1cGVyLnNldEV2ZW50TGlzdGVuZXJzKCk7XG4gICAgdGhpcy5fY29uZmlybUJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKFwiY2xpY2tcIiwgKCkgPT4ge1xuICAgICAgdGhpcy5faGFuZGxlU3VibWl0Q2FsbGJhY2soKTtcbiAgICB9KTtcbiAgfVxufVxuIiwiaW1wb3J0IFBvcHVwIGZyb20gXCIuLi9jb21wb25lbnRzL1BvcHVwLmpzXCI7XG5cbmV4cG9ydCBkZWZhdWx0IGNsYXNzIFBvcHVwV2l0aEltYWdlIGV4dGVuZHMgUG9wdXAge1xuICBjb25zdHJ1Y3Rvcih7IHBvcHVwU2VsZWN0b3IgfSkge1xuICAgIHN1cGVyKHsgcG9wdXBTZWxlY3RvciB9KTtcbiAgICB0aGlzLl9tb2RhbEltYWdlID0gdGhpcy5fcG9wdXBFbGVtZW50LnF1ZXJ5U2VsZWN0b3IoXCIubW9kYWxfX2ltYWdlXCIpO1xuICAgIHRoaXMuX2ltYWdlQ2FwdGlvbiA9IHRoaXMuX3BvcHVwRWxlbWVudC5xdWVyeVNlbGVjdG9yKFwiLm1vZGFsX19jYXB0aW9uXCIpO1xuICB9XG4gIG9wZW4oZGF0YSkge1xuICAgIHRoaXMuX21vZGFsSW1hZ2Uuc3JjID0gZGF0YS5saW5rO1xuICAgIHRoaXMuX21vZGFsSW1hZ2UuYWx0ID0gZGF0YS5uYW1lO1xuICAgIHRoaXMuX2ltYWdlQ2FwdGlvbi50ZXh0Q29udGVudCA9IGRhdGEubmFtZTtcbiAgICBzdXBlci5vcGVuKCk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFNlY3Rpb24ge1xuICBjb25zdHJ1Y3Rvcih7IHJlbmRlcmVyLCBzZWxlY3RvciB9KSB7XG4gICAgLy8gdGhpcy5faXRlbXMgPSBpdGVtcztcbiAgICB0aGlzLl9yZW5kZXJlciA9IHJlbmRlcmVyO1xuICAgIHRoaXMuX2VsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKHNlbGVjdG9yKTtcbiAgfVxuXG4gIHJlbmRlckl0ZW1zKGl0ZW1zKSB7XG4gICAgaXRlbXMuZm9yRWFjaCgoaXRlbSkgPT4ge1xuICAgICAgdGhpcy5fcmVuZGVyZXIoaXRlbSk7XG4gICAgfSk7XG4gIH1cblxuICBhZGRJdGVtKGl0ZW0pIHtcbiAgICB0aGlzLl9lbGVtZW50LnByZXBlbmQoaXRlbSk7XG4gIH1cbn1cbiIsImV4cG9ydCBkZWZhdWx0IGNsYXNzIFVzZXJJbmZvIHtcbiAgY29uc3RydWN0b3IoeyBuYW1lU2VsZWN0b3IsIGRlc2NyaXB0aW9uU2VsZWN0b3IsIGF2YXRhclNlbGVjdG9yIH0pIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IobmFtZVNlbGVjdG9yKTtcbiAgICB0aGlzLl9kZXNjcmlwdGlvbkVsZW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGRlc2NyaXB0aW9uU2VsZWN0b3IpO1xuICAgIHRoaXMuX3Byb2ZpbGVBdmF0YXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKGF2YXRhclNlbGVjdG9yKTtcbiAgfVxuICBnZXRVc2VySW5mbygpIHtcbiAgICByZXR1cm4ge1xuICAgICAgbmFtZTogdGhpcy5fbmFtZUVsZW1lbnQudGV4dENvbnRlbnQsXG4gICAgICBkZXNjcmlwdGlvbjogdGhpcy5fZGVzY3JpcHRpb25FbGVtZW50LnRleHRDb250ZW50LFxuICAgIH07XG4gIH1cblxuICBzZXRVc2VySW5mbyh0aXRsZSwgZGVzY3JpcHRpb24pIHtcbiAgICB0aGlzLl9uYW1lRWxlbWVudC50ZXh0Q29udGVudCA9IHRpdGxlO1xuICAgIHRoaXMuX2Rlc2NyaXB0aW9uRWxlbWVudC50ZXh0Q29udGVudCA9IGRlc2NyaXB0aW9uO1xuICB9XG5cbiAgc2V0QXZhdGFySW1hZ2UoeyBhdmF0YXIgfSkge1xuICAgIHRoaXMuX3Byb2ZpbGVBdmF0YXIuc3JjID0gYXZhdGFyO1xuICB9XG59XG4iLCJleHBvcnQgZGVmYXVsdCBjbGFzcyBBcGkge1xuICBjb25zdHJ1Y3RvcihvcHRpb25zKSB7XG4gICAgLy8gY29uc3RydWN0b3IgYm9keVxuICB9XG5cbiAgLy8gR0VUIC91c2Vycy9tZVxuICBnZXRJbml0aWFsQ2FyZHMoKSB7XG4gICAgcmV0dXJuIGZldGNoKFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjEvY2FyZHNcIiwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiBcIjRlMWQ4MTA5LTllY2UtNDVlOC04Y2NkLTEyYzdlNGEyMTlkZlwiLFxuICAgICAgfSxcbiAgICB9KS50aGVuKChyZXMpID0+IHtcbiAgICAgIGlmIChyZXMub2spIHtcbiAgICAgICAgcmV0dXJuIHJlcy5qc29uKCk7XG4gICAgICB9XG5cbiAgICAgIHJldHVybiBQcm9taXNlLnJlamVjdChgRXJyb3I6ICR7cmVzLnN0YXR1c31gKTtcbiAgICB9KTtcbiAgfVxuXG4gIC8vIEdFVCAvY2FyZHNcbiAgZ2V0VXNlckluZm8oKSB7XG4gICAgcmV0dXJuIGZldGNoKFwiaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjEvdXNlcnMvbWVcIiwge1xuICAgICAgaGVhZGVyczoge1xuICAgICAgICBhdXRob3JpemF0aW9uOiBcIjRlMWQ4MTA5LTllY2UtNDVlOC04Y2NkLTEyYzdlNGEyMTlkZlwiLFxuICAgICAgfSxcbiAgICB9KVxuICAgICAgLnRoZW4oKHJlcykgPT4gcmVzLmpzb24oKSlcbiAgICAgIC50aGVuKChyZXN1bHQpID0+IHtcbiAgICAgICAgY29uc29sZS5sb2cocmVzdWx0KTtcbiAgICAgIH0pO1xuICB9XG4gIGVkaXRQcm9maWxlSW5mbygpIHtcbiAgICByZXR1cm4gZmV0Y2goXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MS91c2Vycy9tZVwiLCB7XG4gICAgICBtZXRob2Q6IFwiUEFUQ0hcIixcbiAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgYXV0aG9yaXphdGlvbjogXCI0ZTFkODEwOS05ZWNlLTQ1ZTgtOGNjZC0xMmM3ZTRhMjE5ZGZcIixcbiAgICAgICAgXCJDb250ZW50LVR5cGVcIjogXCJhcHBsaWNhdGlvbi9qc29uXCIsXG4gICAgICB9LFxuICAgICAgYm9keTogSlNPTi5zdHJpbmdpZnkoe1xuICAgICAgICBuYW1lOiBcIk1hcmllIFNrxYJvZG93c2thIEN1cmllXCIsXG4gICAgICAgIGFib3V0OiBcIlBoeXNpY2lzdCBhbmQgQ2hlbWlzdFwiLFxuICAgICAgfSksXG4gICAgfSkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cbiAgYWRkTmV3Q2FyZCh7IG5hbWUsIGxpbmsgfSkge1xuICAgIHJldHVybiBmZXRjaChcImh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxL2NhcmRzXCIsIHtcbiAgICAgIG1ldGhvZDogXCJQT1NUXCIsXG4gICAgICBoZWFkZXJzOiB7XG4gICAgICAgIGF1dGhvcml6YXRpb246IFwiNGUxZDgxMDktOWVjZS00NWU4LThjY2QtMTJjN2U0YTIxOWRmXCIsXG4gICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgfSxcbiAgICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgICAgbmFtZSxcbiAgICAgICAgbGluayxcbiAgICAgIH0pLFxuICAgIH0pLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG4gIGRlbGV0ZUNhcmQoaWQpIHtcbiAgICByZXR1cm4gZmV0Y2goXG4gICAgICBgaHR0cHM6Ly9hcm91bmQtYXBpLmVuLnRyaXBsZXRlbi1zZXJ2aWNlcy5jb20vdjEvY2FyZHMvJHtpZH1gLFxuICAgICAge1xuICAgICAgICBtZXRob2Q6IFwiREVMRVRFXCIsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBhdXRob3JpemF0aW9uOiBcIjRlMWQ4MTA5LTllY2UtNDVlOC04Y2NkLTEyYzdlNGEyMTlkZlwiLFxuICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICB9LFxuICAgICAgfVxuICAgICkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cbiAgdXBkYXRlUHJvZmlsZVBpY3R1cmUoYXZhdGFyKSB7XG4gICAgcmV0dXJuIGZldGNoKFxuICAgICAgXCJodHRwczovL2Fyb3VuZC1hcGkuZW4udHJpcGxldGVuLXNlcnZpY2VzLmNvbS92MS91c2Vycy9tZS9hdmF0YXJcIixcbiAgICAgIHtcbiAgICAgICAgbWV0aG9kOiBcIlBBVENIXCIsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBhdXRob3JpemF0aW9uOiBcIjRlMWQ4MTA5LTllY2UtNDVlOC04Y2NkLTEyYzdlNGEyMTlkZlwiLFxuICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICB9LFxuICAgICAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICAgICAgYXZhdGFyLFxuICAgICAgICB9KSxcbiAgICAgIH1cbiAgICApLnRoZW4oKHJlcykgPT4ge1xuICAgICAgaWYgKHJlcy5vaykge1xuICAgICAgICByZXR1cm4gcmVzLmpzb24oKTtcbiAgICAgIH1cblxuICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGBFcnJvcjogJHtyZXMuc3RhdHVzfWApO1xuICAgIH0pO1xuICB9XG4gIHVwZGF0ZUxpa2VzKGlzTGlrZWQsIGlkKSB7XG4gICAgcmV0dXJuIGZldGNoKFxuICAgICAgYGh0dHBzOi8vYXJvdW5kLWFwaS5lbi50cmlwbGV0ZW4tc2VydmljZXMuY29tL3YxL2NhcmRzLyR7aWR9L2xpa2VzYCxcbiAgICAgIHtcbiAgICAgICAgbWV0aG9kOiBpc0xpa2VkID8gXCJERUxFVEVcIiA6IFwiUFVUXCIsXG4gICAgICAgIGhlYWRlcnM6IHtcbiAgICAgICAgICBhdXRob3JpemF0aW9uOiBcIjRlMWQ4MTA5LTllY2UtNDVlOC04Y2NkLTEyYzdlNGEyMTlkZlwiLFxuICAgICAgICAgIFwiQ29udGVudC1UeXBlXCI6IFwiYXBwbGljYXRpb24vanNvblwiLFxuICAgICAgICB9LFxuICAgICAgfVxuICAgICkudGhlbigocmVzKSA9PiB7XG4gICAgICBpZiAocmVzLm9rKSB7XG4gICAgICAgIHJldHVybiByZXMuanNvbigpO1xuICAgICAgfVxuXG4gICAgICByZXR1cm4gUHJvbWlzZS5yZWplY3QoYEVycm9yOiAke3Jlcy5zdGF0dXN9YCk7XG4gICAgfSk7XG4gIH1cbn1cbiJdLCJuYW1lcyI6WyJQb3B1cCIsImNvbnN0cnVjdG9yIiwiX3JlZiIsInBvcHVwU2VsZWN0b3IiLCJ0aGlzIiwiX3BvcHVwRWxlbWVudCIsImRvY3VtZW50IiwicXVlcnlTZWxlY3RvciIsIl9jbG9zZUJ1dHRvbiIsIm9wZW4iLCJjbGFzc0xpc3QiLCJhZGQiLCJhZGRFdmVudExpc3RlbmVyIiwiX2hhbmRsZUVzY2FwZSIsImNsb3NlIiwicmVtb3ZlIiwicmVtb3ZlRXZlbnRMaXN0ZW5lciIsImV2dCIsImtleSIsInNldEV2ZW50TGlzdGVuZXJzIiwidGFyZ2V0IiwiY29udGFpbnMiLCJQb3B1cFdpdGhGb3JtIiwiaGFuZGxlRm9ybVN1Ym1pdCIsInN1cGVyIiwiX2hhbmRsZUZvcm1TdWJtaXQiLCJfZm9ybUVsZW1lbnQiLCJfaW5wdXRFbGVtZW50cyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJfc3VibWl0QnV0dG9uIiwiX2dldElucHV0VmFsdWVzIiwiaW5wdXRWYWx1ZXMiLCJmb3JFYWNoIiwiaW5wdXQiLCJuYW1lIiwidmFsdWUiLCJwcmV2ZW50RGVmYXVsdCIsInJlc2V0Rm9ybSIsInJlc2V0IiwicmVuZGVyTG9hZGluZyIsImlzTG9hZGluZyIsInRleHRDb250ZW50IiwiQ2FyZCIsImRhdGEiLCJjYXJkU2VsZWN0b3IiLCJoYW5kbGVJbWFnZUNsaWNrIiwiaGFuZGxlRGVsZXRlQ2xpY2siLCJoYW5kbGVMaWtlQ2xpY2siLCJsaW5rIiwiX2RhdGEiLCJpc0xpa2VkIiwiaWQiLCJfaWQiLCJfY2FyZFNlbGVjdG9yIiwiX2hhbmRsZUltYWdlQ2xpY2siLCJfaGFuZGxlRGVsZXRlQ2xpY2siLCJfaGFuZGxlTGlrZUNsaWNrIiwiX3NldEV2ZW50TGlzdGVuZXJzIiwiX2xpa2VCdXR0b24iLCJfY2FyZEVsZW1lbnQiLCJfY2FyZEltYWdlRWxlbWVudCIsInJlbW92ZUNhcmQiLCJ0b2dnbGVMaWtlSWNvbiIsInRvZ2dsZSIsImdldFZpZXciLCJjb250ZW50IiwiY2xvbmVOb2RlIiwiX2NhcmRUaXRsZSIsImFsdCIsInNyYyIsIkZvcm1WYWxpZGF0b3IiLCJ2YWxpZGF0aW9uU2V0dGluZ3MiLCJmb3JtRWxlbWVudCIsIl9mb3JtIiwiX2lucHV0U2VsZWN0b3IiLCJpbnB1dFNlbGVjdG9yIiwiX3N1Ym1pdEJ1dHRvblNlbGVjdG9yIiwic3VibWl0QnV0dG9uU2VsZWN0b3IiLCJfaW5hY3RpdmVCdXR0b25DbGFzcyIsImluYWN0aXZlQnV0dG9uQ2xhc3MiLCJfaW5wdXRFcnJvckNsYXNzIiwiaW5wdXRFcnJvckNsYXNzIiwiX2Vycm9yQ2xhc3MiLCJlcnJvckNsYXNzIiwiX3Nob3dJbnB1dEVycm9yIiwiaW5wdXRFbGVtZW50cyIsImVycm9yTWVzc2FnZUVsIiwidmFsaWRhdGlvbk1lc3NhZ2UiLCJfaGlkZUlucHV0RXJyb3IiLCJpbnB1dEVsZW1lbnQiLCJfY2hlY2tJbnB1dFZhbGlkaXR5IiwidmFsaWRpdHkiLCJ2YWxpZCIsIl90b2dnbGVCdXR0b25TdGF0ZSIsImZvdW5kSW52YWxpZCIsImRpc2FibGVCdXR0b24iLCJkaXNhYmxlZCIsImVuYWJsZVZhbGlkYXRpb24iLCJlIiwiZGVsZXRlQ2FyZEZvcm0iLCJhZGRDYXJkRm9ybUVsZW1lbnQiLCJlZGl0QXZhdGFyQnV0dG9uIiwiYWRkTmV3Q2FyZEJ1dHRvbiIsInByb2ZpbGVFZGl0QnV0dG9uIiwicHJvZmlsZUVkaXRNb2RhbCIsImF2YXRhckVkaXRNb2RhbCIsInByb2ZpbGVUaXRsZUlucHV0IiwicHJvZmlsZURlc2NyaXB0aW9uSW5wdXQiLCJwcm9maWxlRWRpdEZvcm0iLCJhdmF0YXJFZGl0Rm9ybSIsImFkZEltYWdlQ2FyZE1vZGFsIiwiZmlyc3RFbGVtZW50Q2hpbGQiLCJoYW5kbGVDYXJkQ2xpY2siLCJwb3B1cFdpdGhJbWFnZSIsImNhcmQiLCJwb3B1cERlbGV0ZVdpdGhGb3JtIiwic2V0Q29uZmlybUFjdGlvbiIsImFwaSIsImRlbGV0ZUNhcmQiLCJ0aGVuIiwiY2F0Y2giLCJjb25zb2xlIiwiZXJyb3IiLCJ1cGRhdGVMaWtlcyIsInJlbmRlckNhcmQiLCJjYXJkRGF0YSIsImNhcmRFbGVtZW50IiwiY3JlYXRlQ2FyZCIsInNlY3Rpb24iLCJhZGRJdGVtIiwiYWRkRm9ybVZhbGlkYXRvciIsImVkaXRBdmF0YXJWYWxpZGF0b3IiLCJfY29uZmlybUJ1dHRvbiIsIl9oYW5kbGVTdWJtaXRDYWxsYmFjayIsImNhbGxiYWNrIiwicG9wdXBFZGl0V2l0aEZvcm0iLCJ1c2VySW5mbyIsInNldFVzZXJJbmZvIiwidGl0bGUiLCJkZXNjcmlwdGlvbiIsInBvcHVwQWRkV2l0aEZvcm0iLCJhZGROZXdDYXJkIiwiX21vZGFsSW1hZ2UiLCJfaW1hZ2VDYXB0aW9uIiwicG9wdXBBdmF0YXJFZGl0Rm9ybSIsInVybCIsInVwZGF0ZVByb2ZpbGVQaWN0dXJlIiwic2V0QXZhdGFySW1hZ2UiLCJhdmF0YXIiLCJmaW5hbGx5IiwicmVuZGVyZXIiLCJzZWxlY3RvciIsIl9yZW5kZXJlciIsIl9lbGVtZW50IiwicmVuZGVySXRlbXMiLCJpdGVtcyIsIml0ZW0iLCJwcmVwZW5kIiwibmFtZVNlbGVjdG9yIiwiZGVzY3JpcHRpb25TZWxlY3RvciIsImF2YXRhclNlbGVjdG9yIiwiX25hbWVFbGVtZW50IiwiX2Rlc2NyaXB0aW9uRWxlbWVudCIsIl9wcm9maWxlQXZhdGFyIiwiZ2V0VXNlckluZm8iLCJfcmVmMiIsImluZm8iLCJvcHRpb25zIiwiZ2V0SW5pdGlhbENhcmRzIiwiZmV0Y2giLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsInJlcyIsIm9rIiwianNvbiIsIlByb21pc2UiLCJyZWplY3QiLCJzdGF0dXMiLCJyZXN1bHQiLCJsb2ciLCJlZGl0UHJvZmlsZUluZm8iLCJtZXRob2QiLCJib2R5IiwiSlNPTiIsInN0cmluZ2lmeSIsImFib3V0IiwiYmFzZVVybCIsImFsbCIsImNhcmRzIiwidXNlckRhdGEiXSwic291cmNlUm9vdCI6IiJ9